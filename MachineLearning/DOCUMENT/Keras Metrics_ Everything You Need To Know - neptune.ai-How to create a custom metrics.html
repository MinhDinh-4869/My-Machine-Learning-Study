<!DOCTYPE html>
<!-- saved from url=(0037)https://neptune.ai/blog/keras-metrics -->
<html lang="en-US" class="jetpack-lazy-images-js-enabled"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Keras Metrics: Everything You Need To Know - neptune.ai</title>
  <link rel="preconnect" href="https://fonts.gstatic.com/">
  <link href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/css2" rel="stylesheet">
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v17.3 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://neptune.ai/blog/keras-metrics">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Keras Metrics: Everything You Need To Know - neptune.ai">
	<meta property="og:description" content="Keras metrics are functions that are used to evaluate the performance of your deep learning model. Choosing a good metric for your problem is usually a difficult task. you need to understand which metrics are already available in Keras and tf.keras and how to use them, in many situations you need to define your own custom metric because the […]">
	<meta property="og:url" content="https://neptune.ai/blog/keras-metrics">
	<meta property="og:site_name" content="neptune.ai">
	<meta property="article:publisher" content="https://www.facebook.com/neptuneML/">
	<meta property="article:published_time" content="2020-01-27T08:13:50+00:00">
	<meta property="article:modified_time" content="2021-07-20T11:05:40+00:00">
	<meta property="og:image" content="https://neptune.ai/wp-content/uploads/Keras-metrics.jpg">
	<meta property="og:image:width" content="1920">
	<meta property="og:image:height" content="1377">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@_mwitiderrick">
	<meta name="twitter:site" content="@neptuneml">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Derrick Mwiti">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="12 minutes">
	<script type="text/javascript" async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wqilukic"></script><script type="text/javascript" async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/heap-3102000718.js.download"></script><script type="text/javascript" async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/f.txt"></script><script type="text/javascript" async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/analytics.js.download"></script><script async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/gtm.js.download"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://neptune.ai/#website","url":"https://neptune.ai/","name":"neptune.ai","description":"Metadata store for MLOps, built for teams that run a lot of experiments.","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://neptune.ai/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://neptune.ai/blog/keras-metrics#primaryimage","inLanguage":"en-US","url":"https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-metrics.jpg?fit=1920%2C1377&ssl=1","contentUrl":"https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-metrics.jpg?fit=1920%2C1377&ssl=1","width":1920,"height":1377,"caption":"Keras metrics"},{"@type":"WebPage","@id":"https://neptune.ai/blog/keras-metrics#webpage","url":"https://neptune.ai/blog/keras-metrics","name":"Keras Metrics: Everything You Need To Know - neptune.ai","isPartOf":{"@id":"https://neptune.ai/#website"},"primaryImageOfPage":{"@id":"https://neptune.ai/blog/keras-metrics#primaryimage"},"datePublished":"2020-01-27T08:13:50+00:00","dateModified":"2021-07-20T11:05:40+00:00","author":{"@id":"https://neptune.ai/#/schema/person/fe526844513b28fb08c666bf3baba283"},"breadcrumb":{"@id":"https://neptune.ai/blog/keras-metrics#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://neptune.ai/blog/keras-metrics"]}]},{"@type":"BreadcrumbList","@id":"https://neptune.ai/blog/keras-metrics#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://neptune.ai/blog"},{"@type":"ListItem","position":2,"name":"Model Evaluation","item":"https://neptune.ai/blog/category/model-evaluation"},{"@type":"ListItem","position":3,"name":"Keras Metrics: Everything You Need To Know"}]},{"@type":"Person","@id":"https://neptune.ai/#/schema/person/fe526844513b28fb08c666bf3baba283","name":"Derrick Mwiti","image":{"@type":"ImageObject","@id":"https://neptune.ai/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/625c5e75f1ab6655c608e238f0da365c?s=96&d=blank&r=g","contentUrl":"https://secure.gravatar.com/avatar/625c5e75f1ab6655c608e238f0da365c?s=96&d=blank&r=g","caption":"Derrick Mwiti"},"description":"Derrick Mwiti is a data scientist who has a great passion for sharing knowledge. He is an avid contributor to the data science community via blogs such as Heartbeat, Towards Data Science, Datacamp, Neptune AI, KDnuggets just to mention a few. His content has been viewed over a million times on the internet. Derrick is also an author and online instructor. He also trains and works with various institutions to implement data science solutions as well as to upskill their staff. You might want to check his Complete Data Science &amp; Machine Learning Bootcamp in Python course.","sameAs":["https://www.linkedin.com/in/mwitiderrick/","https://twitter.com/_mwitiderrick"],"url":"https://neptune.ai/blog/author/derrickmwiti"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://secure.gravatar.com/">
<link rel="dns-prefetch" href="https://code.jquery.com/">
<link rel="dns-prefetch" href="https://ajax.googleapis.com/">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
<link rel="dns-prefetch" href="https://stackpath.bootstrapcdn.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="dns-prefetch" href="https://widgets.wp.com/">
<link rel="dns-prefetch" href="https://i0.wp.com/">
<link rel="dns-prefetch" href="https://i1.wp.com/">
<link rel="dns-prefetch" href="https://i2.wp.com/">
<link rel="dns-prefetch" href="https://c0.wp.com/">
<link rel="dns-prefetch" href="https://v0.wordpress.com/">
<link rel="alternate" type="application/rss+xml" title="neptune.ai » Keras Metrics: Everything You Need To Know Comments Feed" href="https://neptune.ai/blog/keras-metrics/feed">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/neptune.ai\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/style.min.css" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="mediaelement-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/mediaelementplayer-legacy.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wp-mediaelement.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-bootstrap-blocks-styles-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/style-index.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="cookie-law-info-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/cookie-law-info-public.css" type="text/css" media="all">
<link rel="stylesheet" id="cookie-law-info-gdpr-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/cookie-law-info-gdpr.css" type="text/css" media="all">
<link rel="stylesheet" id="lbwps-styles-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/default.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="style-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/jquery-3.5.1.min.js.download" id="jquery-js"></script>
<script type="text/javascript" id="cookie-law-info-js-extra">
/* <![CDATA[ */
var Cli_Data = {"nn_cookie_ids":[],"cookielist":[],"non_necessary_cookies":[],"ccpaEnabled":"","ccpaRegionBased":"","ccpaBarEnabled":"","strictlyEnabled":["necessary","obligatoire"],"ccpaType":"gdpr","js_blocking":"1","custom_integration":"","triggerDomRefresh":"","secure_cookies":""};
var cli_cookiebar_settings = {"animate_speed_hide":"500","animate_speed_show":"500","background":"#FFF","border":"#b1a6a6c2","border_on":"","button_1_button_colour":"#00b978","button_1_button_hover":"#009460","button_1_link_colour":"#fff","button_1_as_button":"1","button_1_new_win":"","button_2_button_colour":"#333","button_2_button_hover":"#292929","button_2_link_colour":"#444","button_2_as_button":"","button_2_hidebar":"","button_3_button_colour":"#3566bb","button_3_button_hover":"#2a5296","button_3_link_colour":"#fff","button_3_as_button":"1","button_3_new_win":"","button_4_button_colour":"#000","button_4_button_hover":"#000000","button_4_link_colour":"#333333","button_4_as_button":"","button_7_button_colour":"#61a229","button_7_button_hover":"#4e8221","button_7_link_colour":"#fff","button_7_as_button":"1","button_7_new_win":"","font_family":"inherit","header_fix":"","notify_animate_hide":"1","notify_animate_show":"","notify_div_id":"#cookie-law-info-bar","notify_position_horizontal":"right","notify_position_vertical":"bottom","scroll_close":"","scroll_close_reload":"","accept_close_reload":"","reject_close_reload":"","showagain_tab":"","showagain_background":"#fff","showagain_border":"#000","showagain_div_id":"#cookie-law-info-again","showagain_x_position":"100px","text":"#ccd5ff","show_once_yn":"","show_once":"10000","logging_on":"","as_popup":"","popup_overlay":"1","bar_heading_text":"","cookie_bar_as":"banner","popup_showagain_position":"bottom-right","widget_position":"left"};
var log_object = {"ajax_url":"https:\/\/neptune.ai\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/cookie-law-info-public.js.download" id="cookie-law-info-js"></script>
<link rel="https://api.w.org/" href="https://neptune.ai/wp-json/"><link rel="alternate" type="application/json" href="https://neptune.ai/wp-json/wp/v2/posts/34607"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://neptune.ai/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://neptune.ai/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://wp.me/paIqge-90b">
<link rel="alternate" type="application/json+oembed" href="https://neptune.ai/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fneptune.ai%2Fblog%2Fkeras-metrics">
<link rel="alternate" type="text/xml+oembed" href="https://neptune.ai/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fneptune.ai%2Fblog%2Fkeras-metrics&amp;format=xml">
<style type="text/css">img#wpstats{display:none}</style>
		<style type="text/css"></style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<link rel="amphtml" href="https://neptune.ai/blog/keras-metrics/amp">			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MZNL966');</script>
<!-- End Google Tag Manager -->
<script src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/optimize.js.download"></script><link rel="icon" href="https://i2.wp.com/neptune.ai/wp-content/uploads/2019/03/cropped-Artboard-12.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://i2.wp.com/neptune.ai/wp-content/uploads/2019/03/cropped-Artboard-12.png?fit=192%2C192&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon" href="https://i2.wp.com/neptune.ai/wp-content/uploads/2019/03/cropped-Artboard-12.png?fit=180%2C180&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://i2.wp.com/neptune.ai/wp-content/uploads/2019/03/cropped-Artboard-12.png?fit=270%2C270&amp;ssl=1">
<script async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/hotjar-569747.js.download"></script><script async="" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/modules.da93b7ce7275a1de2dc8.js.download" charset="utf-8"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><script src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/f(1).txt"></script></head>

<body class="post-template-default single single-post postid-34607 single-format-standard sidebar-style-first footer-out-newsletter" style="padding-top: 150px;" data-new-gr-c-s-check-loaded="14.1033.0" data-gr-ext-installed="">
    <header class="header header--blog">
    <div class="container">
      <div class="row header__row">
        <div class="col header__logo">
          <a href="https://neptune.ai/blog">
            <svg width="137" height="27" viewBox="0 0 137 27" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M54.1276 19.1056C54.1276 19.3679 53.7779 19.6303 53.4281 19.6303C52.9909 19.6303 52.7285 19.3679 52.7285 19.1056V12.4597C52.7285 12.1974 52.9909 12.0225 53.4281 12.0225C53.7779 12.0225 54.0402 12.1974 54.0402 12.4597V13.1593C54.39 12.5472 55.0895 11.9351 56.2263 11.9351C57.7129 11.9351 59.0246 13.3342 59.0246 14.9956V19.1056C59.0246 19.4554 58.6748 19.6303 58.325 19.6303C57.9752 19.6303 57.6255 19.4554 57.6255 19.1056V14.9082C57.6255 13.9463 56.751 12.9844 55.7891 12.9844C54.9147 12.9844 54.0402 13.684 54.0402 14.9082V19.1056H54.1276Z" fill="#151928"></path>
              <path d="M67.3336 14.7336C67.3336 16.0453 66.6341 16.0453 65.9345 16.0453H62.4367V16.57C62.4367 17.7942 63.3986 18.5812 64.7103 18.5812C65.9345 18.5812 66.2843 17.9691 66.7215 17.9691C67.0713 17.9691 67.2462 18.3189 67.2462 18.5812C67.2462 19.0184 66.2843 19.718 64.7103 19.718C62.6116 19.718 61.125 18.4938 61.125 16.57V14.9085C61.125 13.247 62.5241 11.8479 64.3605 11.8479C65.9345 11.8479 67.3336 13.0721 67.3336 14.7336ZM65.3224 15.1708C65.9345 15.1708 66.0219 15.0834 66.0219 14.6462C66.0219 13.6843 65.2349 12.8098 64.1856 12.8098C63.1362 12.8098 62.3492 13.5968 62.3492 14.5587V15.1708H65.3224Z" fill="#151928"></path>
              <path d="M70.5695 12.3726V13.0721C70.9193 12.46 71.7063 11.8479 72.7556 11.8479C74.3296 11.8479 75.6413 13.247 75.6413 14.9085V16.57C75.6413 18.144 74.3297 19.718 72.8431 19.718C71.8812 19.718 71.0067 19.1059 70.6569 18.4938V22.866C70.6569 23.1284 70.3072 23.3907 69.9574 23.3907C69.5202 23.3907 69.2578 23.1284 69.2578 22.866V12.3726C69.2578 12.1102 69.5202 11.9353 69.8699 11.9353C70.3072 11.9353 70.5695 12.1102 70.5695 12.3726ZM74.2422 14.9085C74.2422 13.9466 73.3677 12.9847 72.3184 12.9847C71.4439 12.9847 70.5695 13.6843 70.5695 14.9085V17.0072C70.5695 17.4444 71.3565 18.4938 72.4059 18.4938C73.3678 18.4938 74.2422 17.5319 74.2422 16.57V14.9085Z" fill="#151928"></path>
              <path d="M78.9636 17.0946C78.9636 18.0565 79.3134 18.3189 80.2753 18.3189H80.7999C81.1497 18.3189 81.4121 18.5812 81.4121 18.931C81.4121 19.2808 81.1497 19.5431 80.7999 19.5431H80.2753C78.5264 19.5431 77.5645 18.7561 77.5645 17.0946V8.78732C77.5645 8.52499 77.9142 8.3501 78.264 8.3501C78.6138 8.3501 78.9636 8.52499 78.9636 8.78732V11.8479H80.9748C81.2372 11.8479 81.4121 12.1103 81.4121 12.3726C81.4121 12.6349 81.2372 12.8973 80.9748 12.8973H78.9636V17.0946Z" fill="#151928"></path>
              <path d="M83.0723 16.57V12.3726C83.0723 12.1102 83.3346 11.8479 83.7718 11.8479C84.1216 11.8479 84.4714 12.1102 84.4714 12.3726V16.57C84.4714 17.5319 85.2584 18.4938 86.3077 18.4938C87.3571 18.4938 88.1441 17.5319 88.1441 16.57V12.3726C88.1441 12.1102 88.4939 11.9353 88.8437 11.9353C89.2809 11.9353 89.5432 12.1977 89.5432 12.3726V16.57C89.5432 18.2314 88.1441 19.6305 86.3952 19.6305C84.4714 19.718 83.0723 18.2314 83.0723 16.57Z" fill="#151928"></path>
              <path d="M93.0417 19.1056C93.0417 19.3679 92.6919 19.6303 92.3421 19.6303C91.9049 19.6303 91.6426 19.3679 91.6426 19.1056V12.4597C91.6426 12.1974 91.9049 12.0225 92.3421 12.0225C92.6919 12.0225 92.9543 12.1974 92.9543 12.4597V13.1593C93.304 12.5472 94.0036 11.9351 95.1404 11.9351C96.627 11.9351 97.9386 13.3342 97.9386 14.9956V19.1056C97.9386 19.4554 97.5889 19.6303 97.2391 19.6303C96.8893 19.6303 96.5395 19.4554 96.5395 19.1056V14.9082C96.5395 13.9463 95.6651 12.9844 94.7032 12.9844C93.8287 12.9844 92.9543 13.684 92.9543 14.9082V19.1056H93.0417Z" fill="#151928"></path>
              <path d="M106.334 14.7336C106.334 16.0453 105.634 16.0453 104.934 16.0453H101.437V16.57C101.437 17.7942 102.399 18.5812 103.71 18.5812C104.934 18.5812 105.284 17.9691 105.722 17.9691C106.071 17.9691 106.246 18.3189 106.246 18.5812C106.246 19.0184 105.284 19.718 103.71 19.718C101.612 19.718 100.125 18.4938 100.125 16.57V14.9085C100.125 13.247 101.524 11.8479 103.36 11.8479C104.847 11.8479 106.334 13.0721 106.334 14.7336ZM104.322 15.1708C104.935 15.1708 105.022 15.0834 105.022 14.6462C105.022 13.6843 104.235 12.8098 103.186 12.8098C102.136 12.8098 101.349 13.5968 101.349 14.5587V15.1708H104.322Z" fill="#151928"></path>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M38.2132 23.8278C39.0002 22.0789 39.3499 19.8927 39.6997 17.7941C39.7872 17.1819 39.9621 16.6573 40.0495 16.1326C40.2244 15.1707 40.3118 14.5586 40.3118 13.859C40.2244 13.1594 39.6997 12.4599 38.9127 12.4599C37.8634 12.3724 37.3387 12.8971 37.1638 13.9465L36.7266 15.7828C36.4642 17.1819 36.2019 18.5811 35.9396 20.0676C35.9396 20.1551 35.9396 20.2425 35.8521 20.33C35.6772 21.3793 35.5023 21.904 35.24 22.2538C35.1526 22.3412 34.8028 22.691 34.2781 22.6035C34.0158 22.5161 33.666 22.3412 33.4037 21.7291C33.3162 21.2919 33.2288 20.5049 33.1413 20.0676C32.879 18.9308 32.7041 17.7941 32.4417 16.6573C31.9171 14.2088 31.4798 11.6729 30.8677 9.13695C30.4305 7.21315 29.8184 5.20191 29.0314 3.19066C28.3318 1.44175 27.4574 0.742188 25.9708 0.742188C24.2219 0.742188 23.3474 1.87898 22.6479 3.19066C21.686 5.11446 21.1613 7.3006 20.6366 9.74907C20.1994 11.8478 19.7622 13.9465 19.4124 15.9577C19.15 17.007 18.9752 18.0564 18.8003 19.1057C18.8003 19.1932 18.2756 21.3793 18.2756 21.5542C18.0133 22.1663 17.6635 22.4287 17.3137 22.4287C16.7016 22.4287 16.3518 21.6417 16.3518 21.4668C16.3518 21.3793 16.1769 20.8546 16.0894 20.7672C16.002 20.5049 15.9146 20.2425 15.8271 19.9802C15.5648 18.8434 15.3899 17.6192 15.1275 16.4824C14.6029 14.0339 14.1657 11.498 13.5535 8.96206C13.1163 7.03826 12.5042 5.11446 11.7172 3.19066C11.1051 1.61664 9.96827 1.00452 8.91892 1.00452C8.91892 1.00452 6.5579 0.917078 5.50855 3.27811C4.6341 5.11446 3.93453 7.21315 3.32241 9.92396C2.97263 11.5854 2.7103 12.8097 2.62285 13.9465C2.53541 14.646 3.06008 15.3456 3.6722 15.6079C4.19687 15.7828 4.6341 15.7828 5.07132 15.5205C5.42111 15.2581 5.68344 14.9084 5.85833 14.3837C6.12067 13.1594 6.38301 11.8478 6.5579 10.6235C6.73279 10.0114 7.34491 6.68848 7.5198 6.25125C7.69469 5.81402 7.95702 4.93957 8.56914 4.93957C8.56914 4.93957 8.56914 4.93957 8.65659 4.93957C9.2687 5.02701 9.53104 5.81402 9.70593 6.51359C9.79338 6.86337 9.96827 7.73782 10.1432 8.52483C10.2306 8.96206 10.318 9.31184 10.4055 9.57418C10.6678 10.7984 10.9302 12.1101 11.1925 13.3343C11.3674 14.0339 11.5423 14.7335 11.6297 15.433C12.1544 17.7066 12.5916 19.9802 13.2038 22.2538C13.5535 23.5655 14.1657 24.7022 14.6029 25.4018C15.1276 26.2763 16.002 26.8009 16.9639 26.8009C18.5379 26.8884 19.9371 25.7516 20.6366 23.9152C21.5985 21.3793 22.1232 18.6685 22.7353 15.9577C22.7353 15.9577 24.047 9.31184 24.3093 8.0876C24.3968 7.73782 24.7465 6.16381 24.834 5.90147C25.1838 4.85212 25.7085 4.76468 25.8833 4.76468H25.9708C26.6704 4.76468 27.1076 5.72658 27.6322 8.69972L27.7197 8.87461C28.0695 10.2737 28.3318 11.6729 28.5942 13.072C29.1188 15.5205 29.5561 17.9689 30.0807 20.33C30.518 22.4287 31.1301 23.8278 32.0045 25.052C33.1413 26.7135 34.8028 27.0633 36.4642 26.0139C37.1638 25.6641 37.7759 24.7897 38.2132 23.8278Z" fill="#151928"></path>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M2.01125 22.6035C0.874454 22.6035 0 23.5654 0 24.7022C0 25.2269 0.262336 25.6641 0.612118 26.1013C1.04935 26.5386 1.48657 26.7135 2.01125 26.7135C2.53592 26.7135 3.06059 26.4511 3.41037 26.0139C3.76015 25.5767 4.02249 25.1394 4.02249 24.6148C4.02249 23.5654 3.06059 22.6035 2.01125 22.6035Z" fill="#151928"></path>
              <path d="M108.756 18.8438V8.00055C108.756 7.82566 108.843 7.65076 109.018 7.56332C109.193 7.47587 109.455 7.38843 109.718 7.38843C109.98 7.38843 110.242 7.47587 110.505 7.56332C110.68 7.65076 110.855 7.82566 110.855 8.00055V12.9849C111.029 12.6352 111.292 12.3728 111.642 12.1105C111.991 11.8481 112.429 11.7607 112.866 11.7607C113.653 11.7607 114.352 12.1105 114.877 12.7226C115.402 13.3347 115.751 14.1217 115.751 14.9962V16.3079C115.751 17.1823 115.489 17.9693 114.877 18.5814C114.265 19.281 113.653 19.5433 112.866 19.5433C112.341 19.5433 111.904 19.4559 111.467 19.1936C111.029 18.9312 110.767 18.6689 110.592 18.3191V18.7563C110.592 18.9312 110.505 19.1061 110.33 19.1936C110.155 19.3685 109.893 19.3685 109.63 19.3685C109.368 19.3685 109.106 19.281 108.931 19.1936C108.931 19.1936 108.756 19.0187 108.756 18.8438ZM110.855 16.6576C110.855 16.8325 111.029 17.0949 111.292 17.4447C111.554 17.7944 111.904 17.8819 112.341 17.8819C112.778 17.8819 113.041 17.707 113.303 17.4447C113.565 17.1823 113.74 16.8325 113.74 16.3953V15.0836C113.74 14.7338 113.565 14.3841 113.303 14.1217C113.041 13.8594 112.691 13.6845 112.341 13.6845C111.991 13.6845 111.642 13.8594 111.379 14.1217C111.117 14.3841 110.942 14.7338 110.942 15.1711V16.6576H110.855Z" fill="#151928"></path>
              <path d="M117.676 18.8435V8.0003C117.676 7.82541 117.763 7.65052 117.938 7.56307C118.113 7.47563 118.375 7.38818 118.725 7.38818C118.987 7.38818 119.25 7.47563 119.512 7.56307C119.687 7.65052 119.862 7.82541 119.862 8.0003V18.8435C119.862 19.0184 119.774 19.1933 119.512 19.2808C119.337 19.4557 119.075 19.4557 118.813 19.4557C118.55 19.4557 118.288 19.3682 118.113 19.2808C117.938 19.1933 117.676 19.0184 117.676 18.8435Z" fill="#151928"></path>
              <path d="M121.611 16.3951V15.0834C121.611 14.2089 121.961 13.4219 122.661 12.8098C123.36 12.1977 124.147 11.8479 125.109 11.8479C126.071 11.8479 126.858 12.1977 127.558 12.8098C128.257 13.4219 128.607 14.2089 128.607 15.0834V16.3951C128.607 17.2695 128.257 18.0565 127.558 18.6686C126.858 19.3682 126.071 19.6305 125.109 19.6305C124.147 19.6305 123.36 19.2808 122.661 18.6686C121.961 17.9691 121.611 17.2695 121.611 16.3951ZM123.71 16.3951C123.71 16.7448 123.885 17.0946 124.147 17.4444C124.41 17.7067 124.759 17.8816 125.109 17.8816C125.459 17.8816 125.809 17.7067 126.071 17.4444C126.333 17.1821 126.508 16.8323 126.508 16.3951V15.0834C126.508 14.7336 126.333 14.3838 126.071 14.1215C125.809 13.8591 125.459 13.6843 125.109 13.6843C124.759 13.6843 124.41 13.8591 124.147 14.1215C123.885 14.3838 123.71 14.7336 123.71 15.0834V16.3951Z" fill="#151928"></path>
              <path d="M129.83 20.8547C129.83 20.0677 130.267 19.543 131.054 19.1058C130.617 18.9309 130.355 18.5811 130.355 18.0565C130.355 17.6192 130.617 17.182 131.142 16.8322C130.442 16.3076 130.18 15.608 130.18 14.7335V14.3838C130.18 13.5968 130.442 12.9846 131.054 12.46C131.666 11.9353 132.366 11.673 133.328 11.673C134.027 11.673 134.64 11.8478 135.164 12.1102C135.514 11.4106 135.776 10.9734 136.126 10.9734C136.388 10.9734 136.563 11.0608 136.738 11.1483C136.913 11.2357 137.001 11.4106 137.001 11.5855C137.001 11.7604 136.913 11.9353 136.738 12.0227C136.301 12.2851 136.126 12.5474 135.951 12.6349C136.301 13.0721 136.476 13.5968 136.476 14.2089V14.7335C136.476 15.5206 136.214 16.1327 135.601 16.6573C134.989 17.182 134.202 17.4444 133.328 17.4444C132.978 17.4444 132.628 17.3569 132.279 17.2695C132.191 17.3569 132.104 17.4444 132.104 17.6192C132.104 17.7941 132.279 17.969 132.628 18.0565C132.978 18.1439 133.328 18.2314 133.853 18.2314C134.29 18.3188 134.814 18.4063 135.252 18.4937C135.689 18.5811 136.126 18.8435 136.476 19.1933C136.826 19.543 137.001 19.9803 137.001 20.5924C137.001 21.4668 136.651 22.079 135.951 22.5162C135.252 22.9534 134.465 23.1283 133.415 23.1283C132.453 23.1283 131.579 22.9534 130.879 22.5162C130.18 22.079 129.83 21.5543 129.83 20.8547ZM131.754 20.5924C131.754 20.9422 131.929 21.2045 132.191 21.4668C132.453 21.7292 132.891 21.8166 133.328 21.8166C133.765 21.8166 134.115 21.7292 134.465 21.4668C134.814 21.2045 134.902 21.0296 134.902 20.6798C134.902 20.5049 134.902 20.4175 134.814 20.2426C134.727 20.1552 134.64 20.0677 134.552 19.9803C134.377 19.8928 134.29 19.8054 134.202 19.8054C134.115 19.7179 133.94 19.7179 133.678 19.7179C133.415 19.7179 133.328 19.6305 133.153 19.6305C133.066 19.6305 132.891 19.6305 132.628 19.543C132.104 19.8054 131.754 20.1552 131.754 20.5924ZM132.191 14.7335C132.191 15.1708 132.279 15.5206 132.541 15.7829C132.716 16.0452 133.066 16.2201 133.415 16.2201C133.765 16.2201 134.027 16.0452 134.29 15.7829C134.465 15.5206 134.64 15.1708 134.64 14.7335V14.3838C134.64 13.9465 134.552 13.6842 134.29 13.4219C134.115 13.1595 133.765 12.9846 133.415 12.9846C133.066 12.9846 132.803 13.1595 132.541 13.4219C132.366 13.6842 132.191 14.034 132.191 14.4712V14.7335Z" fill="#151928"></path>
            </svg>
          </a>
        </div>

        <nav class="col header__nav">
          <button class="header__hamburger">
            <span class="header__hamburger-line"></span>
          </button>

          


<form action="https://neptune.ai/" method="get" class="header__search header__search--tablet">
  <input type="text" id="autocomplate" name="s" value="" placeholder="Search all articles" class="header__search-input">
    <input type="hidden" value="post" name="post_type">
  <input type="submit" class="header__search-submit">
  <div class="ajax-results"></div>
</form>          <ul class="nav__list "><li class="nav__item  nav__item--21343  nav__item--green"><a href="https://neptune.ai/product" class="nav__link">What is Neptune?</a></li>

  <li class="header__button header__tablet header__newsletter  header-newsletter ">
    <form action="https://neptune.us19.list-manage.com/subscribe/post?u=8da2bdd288186da3ffeec5626&amp;id=59d3dc2c24" method="post" target="_blank" class="header-newsletter__form">
    <input type="email" class="header-newsletter__form-email" name="EMAIL" placeholder="Type your email here">
    <input type="submit" class="header-newsletter__form-button button blue-not-filled" value="Get Newsletter">
    </form>
  </li>
  <ul class="header__socials nav__social">
        
                        <li class="header__socials-single">
                <a href="https://www.linkedin.com/company/neptuneai" class="header__socials-url">
                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/icon-lk-2.svg" class="header__socials-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="1294" data-permalink="https://neptune.ai/icon-lk-2" data-orig-file="https://neptune.ai/wp-content/uploads/icon-lk-2.svg" data-orig-size="30,30" data-comments-opened="1" data-image-meta="[]" data-image-title="icon-lk-2" data-image-description="" data-image-caption="" data-medium-file="https://neptune.ai/wp-content/uploads/icon-lk-2.svg" data-large-file="https://neptune.ai/wp-content/uploads/icon-lk-2.svg" data-lazy-src="https://neptune.ai/wp-content/uploads/icon-lk-2.svg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                </a>
            </li>
        
                        <li class="header__socials-single">
                <a href="https://twitter.com/neptune_ai" class="header__socials-url">
                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/icon-tw-2.svg" class="header__socials-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="1295" data-permalink="https://neptune.ai/icon-tw-2" data-orig-file="https://neptune.ai/wp-content/uploads/icon-tw-2.svg" data-orig-size="30,30" data-comments-opened="1" data-image-meta="[]" data-image-title="icon-tw-2" data-image-description="" data-image-caption="" data-medium-file="https://neptune.ai/wp-content/uploads/icon-tw-2.svg" data-large-file="https://neptune.ai/wp-content/uploads/icon-tw-2.svg" data-lazy-src="https://neptune.ai/wp-content/uploads/icon-tw-2.svg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                </a>
            </li>
        
                        <li class="header__socials-single">
                <a href="https://www.facebook.com/neptuneAI" class="header__socials-url">
                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/icon-fb-2.svg" class="header__socials-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="1296" data-permalink="https://neptune.ai/icon-fb-2" data-orig-file="https://neptune.ai/wp-content/uploads/icon-fb-2.svg" data-orig-size="30,30" data-comments-opened="1" data-image-meta="[]" data-image-title="icon-fb-2" data-image-description="" data-image-caption="" data-medium-file="https://neptune.ai/wp-content/uploads/icon-fb-2.svg" data-large-file="https://neptune.ai/wp-content/uploads/icon-fb-2.svg" data-lazy-src="https://neptune.ai/wp-content/uploads/icon-fb-2.svg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                </a>
            </li>
        
                </ul></ul>                  </nav>
      </div>

      <!-- new version -->

              <div class="header-categories">
                      <div class="header-categories__list header-categories__list--top">
                <a class="header-categories__list-single" href="https://neptune.ai/blog/category/how-to-use-neptune">How to Use Neptune</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/experiment-tracking">ML Experiment Tracking</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/machine-learning-model-management">ML Model Management</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/mlops">MLOps</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/machine-learning-tools">ML Tools</a>
              


<form action="https://neptune.ai/" method="get" class="header__search header-categories__search">
  <input type="text" id="autocomplate" name="s" value="" placeholder="Search all articles" class="header__search-input">
    <input type="hidden" value="post" name="post_type">
  <input type="submit" class="header__search-submit">
  <div class="ajax-results"></div>
</form>            </div>
          
                      <div class="header-categories__list header-categories__list--bottom">
                <a class="header-categories__list-single" href="https://neptune.ai/blog/category/computer-vision">Computer Vision</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/natural-language-processing">Natural Language Processing</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/reinforcement-learning">Reinforcement Learning</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/tabular-data">Tabular Data</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/hyperparameter-optimization">Hyperparameter Optimization</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/model-evaluation">Model Evaluation</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/time-series-forecasting">Time Series</a>
  <a class="header-categories__list-single" href="https://neptune.ai/blog/category/ml-project-management">ML Project Management</a>
            </div>
                      <a href="https://neptune.ai/blog/keras-metrics#slideDown" class="header-categories__more"></a>
                  </div>
          </div>
  </header>
<main class="main blog">
  <section class="section blog__section singlePost container">
    <p id="breadcrumbs" class="article__breadcrumbs breadcrumbs"><span><span><a href="https://neptune.ai/blog">Blog</a> » <span><a href="https://neptune.ai/blog/category/model-evaluation">Model Evaluation</a> » <span class="breadcrumb_last" aria-current="page">Keras Metrics: Everything You Need To Know</span></span></span></span></p>    <div class="article__row row">
              <aside class="col-12 col-lg-3 sidebar" style="margin-top: -100px;">        <div class="before-sidebar-newsletter" style="width: 409.2px;"></div>
<a href="https://docs.neptune.ai/integrations-and-supported-tools/model-training/tensorflow-keras" target="_blank" class="sidebar-newsletter sidebar-newsletter--sticky" style="width: 344.222px;">
    <img src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/chart.svg">    <div class="sidebar-newsletter__content"><p><strong>Want to seamlessly track ALL your model training metadata</strong> (metrics, parameters, hardware consumption, etc.)?</p>
<p>Integrate TensorFlow/Keras with Neptune in 5 mins.</p>
</div>
            <span class="button green-filled sidebar-newsletter__button">
            Check how        </span>
    
</a></aside>
      
      <article class="col-12 col-lg-9 article">
        <header class="article__header col-lg-10">  <h1 class="article__title">Keras Metrics: Everything You Need To Know</h1>
  <ul class="article__info">
    <li class="article__info-single article__info--read-single">
      <span class="article__info-time">9</span>
      <span class="article__info-mins">mins</span>
      <span class="article__info-read">read</span>
    </li>
    <li class="article__info-single">
        Author Derrick Mwiti    </li>
          <li class="article__info-single">Updated July 20th, 2021</li>
      </ul>
</header>
        <div class="article__content col-lg-10">
<p>Keras metrics are functions that are used to evaluate the performance of your deep learning model. Choosing a good metric for your problem is usually a difficult task.</p>


<div class="custom-point-list">
<ul><li>you need to understand&nbsp;<strong>which metrics are already available</strong>&nbsp;in Keras and tf.keras and how to use them,</li><li>in many situations you need to&nbsp;<strong>define your own custom metric</strong>&nbsp;because the metric you are looking for doesn’t ship with Keras.</li><li>sometimes you want to&nbsp;<strong>monitor model performance by looking at charts like ROC curve or Confusion Matrix</strong>&nbsp;after every epoch.</li></ul>
</div>

<div class="note">
    <h3>Some terms that will be explained in this article:</h3>
    <div class="content">
                    <div class="wysiwyg_editor">
                                    <ul id="block-4c25750e-81b5-410c-ba1f-bb452e425e74" class="block-editor-block-list__block is-selected rich-text block-editor-rich-text__editable wp-block" tabindex="0" role="textbox" contenteditable="true" spellcheck="false" aria-label="Write list…" aria-multiline="true" data-block="4c25750e-81b5-410c-ba1f-bb452e425e74" data-type="core/list" data-title="List">
<li>keras metrics accuracy</li>
<li>keras compile metrics</li>
<li>keras custom metric</li>
<li>keras metrics for regression</li>
<li>keras confusion matrix</li>
<li>tf.kerac.metrics.meaniou</li>
<li>tf.keras.metrics f1 score</li>
<li>tf.keras.metrics.auc</li>
</ul>
                            </div>
            </div>
</div>



<h2>Keras metrics 101</h2>



<p>In Keras, metrics are passed during the compile stage as shown below. You can pass several metrics by comma separating them.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> keras <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> metrics

model.compile(loss=<span class="hljs-string" style="color: rgb(221, 17, 68);">'mean_squared_error'</span>, optimizer=<span class="hljs-string" style="color: rgb(221, 17, 68);">'sgd'</span>,
              metrics=[metrics.mae,
                       metrics.categorical_accuracy])</div></pre>



<p>How you should choose those evaluation metrics?</p>



<p>Some of them are available in Keras, others in tf.keras. Sometimes you need to implement your own custom metrics.</p>



<p>Let’s go over all of those situations.</p>



<h2>Which metrics are available in Keras?</h2>



<p>Keras provides a rich pool of inbuilt metrics. Depending on your problem, you’ll use different ones.</p>



<p>Let’s look at some of the problems you may be working on.</p>



<h3>Binary classification</h3>



<p>Binary classification metrics are used on computations that involve just two classes. A good example is building a deep learning&nbsp;<strong>model to predict cats and dogs</strong>. We have two classes to predict and the threshold determines the point of separation between them. <strong><em>binary_accuracy</em></strong>&nbsp;and&nbsp;<strong><em>accuracy</em></strong>&nbsp;are two such functions in Keras.</p>



<p><em><strong>binary_accuracy</strong>,&nbsp;</em>for example, computes the mean accuracy rate across all predictions for binary classification problems.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.binary_accuracy(y_true, y_pred, threshold=<span class="hljs-number" style="color: teal;">0.5</span>)
</div></pre>



<p>The&nbsp;<strong><em>accuracy</em></strong>&nbsp;metric computes the accuracy rate across all predictions.&nbsp;<em>y_true</em>&nbsp;represents the true labels while&nbsp;<em>y_pred</em>&nbsp;represents the predicted ones.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.accuracy(y_true, y_pred)
</div></pre>



<p>The&nbsp;<em><strong>confusion_matrix</strong></em>&nbsp;displays a table showing the true positives, true negatives, false positives, and false negatives.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.confusion_matrix(y_test, y_pred)
</div></pre>



<div class="wp-block-image"><figure class="aligncenter"><img src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/confusion_matrix.png" alt="keras confusion matrix"></figure></div>



<p>In the above confusion matrix, the model made 3305 + 375 correct predictions and 106 + 714 wrong predictions.</p>



<p>You can also visualize it as a matplotlib chart which we will cover later.</p>


<div class="note">
    <h3>What is Keras accuracy?</h3>
    <div class="content">
                    <div class="wysiwyg_editor">
                                    <p>It seems simple but in reality it’s not obvious.</p>
                            </div>
                    <div class="wysiwyg_editor">
                                    <p>As&nbsp; explained&nbsp;<a href="https://github.com/sagr4019/ResearchProject/wiki/General-Terminology#difference-between-accuracy-and-categorical_accuracy" target="_blank" rel="noreferrer noopener">here</a>:</p>
                            </div>
                    <div class="wysiwyg_editor">
                                    <blockquote><p>The term “accuracy” is an expression, to let the&nbsp;<a href="https://github.com/keras-team/keras/blob/d8b226f26b35348d934edb1213061993e7e5a1fa/keras/engine/training.py#L651" target="_blank" rel="noopener">training file</a>&nbsp;decide which metric should be used (<strong>binary accuracy</strong>,&nbsp;<strong>categorial accuracy</strong>&nbsp;or&nbsp;<strong>sparse categorial accuracy</strong>). This decision is based on certain parameters like the output shape (the shape of the tensor that is produced by the layer and that will be the input of the next layer) and the loss functions.</p></blockquote>
                            </div>
                    <div class="wysiwyg_editor">
                                    <p>So sometimes it is good to question even the simplest things, especially when something unexpected happens with your metrics.</p>
                            </div>
            </div>
</div>



<h3>Multiclass classification</h3>



<p>These metrics are used for classification&nbsp;<strong>problems involving more than two classes</strong>. Extending our animal classification example you can have three animals, cats, dogs, and bears. Since we are classifying more than two animals, this is a multiclass classification problem.</p>



<p>The shape of&nbsp;<em>y_true</em>&nbsp;is the number of entries by 1 that is (n,1) but the shape of&nbsp;<em>y_pred</em>&nbsp;is the number of entries by number of classes(n,c)</p>



<p><em><strong>categorical_accuracy</strong></em>&nbsp;metric computes the mean accuracy rate across all predictions.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.categorical_accuracy(y_true, y_pred)
</div></pre>



<p><em><strong>sparse_categorical_accuracy</strong></em>&nbsp;is similar to the&nbsp;<em>categorical_accuracy</em>&nbsp;but mostly used&nbsp;<strong>when making predictions for sparse targets</strong>. A great example of this is working with text in deep learning problems such as word2vec. In this case, one works with&nbsp;<strong>thousands of classes</strong>&nbsp;with the aim of predicting the next word. This task produces a situation where the y_true is a huge matrix that is almost all zeros, a perfect spot to use a sparse matrix.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.sparse_categorical_accuracy(y_true, y_pred)
</div></pre>



<p><em><strong>top_k_categorical_accuracy</strong></em>&nbsp;computes the top-k-categorical accuracy rate. We take top k predicted classes from our model and see if the correct class was selected as top k. If it was we say that our model was correct.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>keras.metrics.top_k_categorical_accuracy(y_true, y_pred, k=<span class="hljs-number" style="color: teal;">5</span>)
</div></pre>



<h3>Regression</h3>



<p>The metrics used in regression problems include<strong>&nbsp;Mean Squared Error, Mean Absolute Error, and Mean Absolute Percentage Error.</strong>&nbsp;These metrics are used when predicting numerical values such as sales and prices of houses. Check out this resource for a&nbsp;<a href="https://scikit-learn.org/stable/modules/model_evaluation.html#regression-metrics" target="_blank" rel="noreferrer noopener">complete guide on regression metrics.</a></p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> keras <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> metrics

model.compile(loss=<span class="hljs-string" style="color: rgb(221, 17, 68);">'mse'</span>, optimizer=<span class="hljs-string" style="color: rgb(221, 17, 68);">'adam'</span>, 
              metrics=[metrics.mean_squared_error, 
                       metrics.mean_absolute_error, 
                       metrics.mean_absolute_percentage_error])
                       metrics.categorical_accuracy])</div></pre>





<h2>How to create a custom metric in Keras?</h2>



<p>As we had mentioned earlier, Keras also allows you to define your own custom metrics.</p>



<p>The function you define&nbsp;<strong>has to take&nbsp;<em>y_true</em>&nbsp;and&nbsp;<em>y_pred</em>&nbsp;as arguments and must return a single tensor value</strong>. These objects are of type Tensor with float32 data type.The shape of the object is the number of rows by 1. For example, if you have 4,500 entries the shape will be (4500, 1).</p>



<p>You can use the function by passing it at the compilation stage of your deep learning model.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(...metrics=[your_custom_metric])</div></pre>



<h3>How to calculate F1 score in Keras (precision, and recall as a bonus)?</h3>



<p>Let’s see how you can compute the<strong>&nbsp;f1 score, precision and recall in Keras.</strong>&nbsp;We will create it for the multiclass scenario but you can also use it for binary classification.</p>



<p>The&nbsp;<a href="https://neptune.ai/blog/evaluation-metrics-binary-classification#10" target="_blank" rel="noreferrer noopener">f1 score is the weighted average of precision and recall.</a>&nbsp;So to calculate f1 we need to create functions that calculate precision and recall first. Note that in multiclass scenario you need to look at all classes not just the positive class (which is the case for binary classification)</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">recall</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    y_true = K.ones_like(y_true) 
    true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    all_positives = K.sum(K.round(K.clip(y_true, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    
    recall = true_positives / (all_positives + K.epsilon())
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> recall

<span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">precision</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    y_true = K.ones_like(y_true) 
    true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    
    predicted_positives = K.sum(K.round(K.clip(y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    precision = true_positives / (predicted_positives + K.epsilon())
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> precision

<span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">f1_score</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    precision = precision_m(y_true, y_pred)
    recall = recall_m(y_true, y_pred)
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> <span class="hljs-number" style="color: teal;">2</span>*((precision*recall)/(precision+recall+K.epsilon()))
</div></pre>



<p>The next step is to use these functions at the compilation stage of our deep learning model. We are also adding the Keras&nbsp;<em>accuracy</em>&nbsp;metric that is available by default.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(...,metrics=[<span class="hljs-string" style="color: rgb(221, 17, 68);">'accuracy'</span>, f1_score, precision, recall])
</div></pre>



<p>Let’s now fit the model to the training and test set.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.fit(x_train, y_train, epochs=<span class="hljs-number" style="color: teal;">5</span>)
</div></pre>



<p>Now you can evaluate your model and access the metrics you have just created.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>(loss, 
accuracy, 
f1_score, precision, recall) = model.evaluate(x_test, y_test, verbose=<span class="hljs-number" style="color: teal;">1</span>)
</div></pre>



<p>Great, you now know how to create custom metrics in keras.</p>



<p>That said, sometimes you can use something that is already there, just in a different library like tf.keras <img draggable="false" role="img" class="emoji" alt="🙂" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/1f642.svg"></p>



<h2>Which metrics are available in tf.keras?</h2>



<p>Recently&nbsp;<strong>Keras has become a standard API in TensorFlow</strong>&nbsp;and there are a lot of useful metrics that you can use.</p>



<p>Let’s look at some of them. Unlike in Keras where you just call the metrics using&nbsp;<em>keras.metrics</em>&nbsp;functions, in tf.keras you have to instantiate a&nbsp;<em>Metric</em>&nbsp;class.&nbsp;</p>



<p>For example:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>tf.keras.metrics.Accuracy() 
</div></pre>



<p><strong>There is quite a bit of overlap between keras metrics and tf.keras</strong>. However, there are some metrics that you can only find in tf.keras.</p>



<p>Let’s take a look at those.</p>



<h3>tf.keras classification metrics</h3>



<p><strong><em>tf.keras.metrics.AUC</em></strong>&nbsp;computes the approximate AUC (Area under the curve) for ROC curve via the&nbsp;<a href="https://www.khanacademy.org/math/ap-calculus-ab/ab-integration-new/ab-6-2/a/left-and-right-riemann-sums" target="_blank" rel="noreferrer noopener">Riemann sum</a>.&nbsp;</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(<span class="hljs-string" style="color: rgb(221, 17, 68);">'sgd'</span>, loss=<span class="hljs-string" style="color: rgb(221, 17, 68);">'mse'</span>, metrics=[tf.keras.metrics.AUC()])
</div></pre>



<p>You can use precision and recall that we have implemented before, out of the box in tf.keras.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(<span class="hljs-string" style="color: rgb(221, 17, 68);">'sgd'</span>, loss=<span class="hljs-string" style="color: rgb(221, 17, 68);">'mse'</span>, 
               metrics=[tf.keras.metrics.Precision(), 
                        tf.keras.metrics.Recall()])
</div></pre>



<h3>tf.keras segmentation metrics</h3>



<p><em><strong>tf.keras.metrics.MeanIoU</strong></em>&nbsp;–&nbsp;<em>Mean Intersection-Over-Union</em>&nbsp;is a metric used for the evaluation of semantic image segmentation models. We first calculate the IOU for each class:</p>



<div class="wp-block-image"><figure class="aligncenter is-resized"><img loading="lazy" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/IOU.png" alt="keras iou" width="575" height="53"></figure></div>



<p>And average over all classes.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(... metrics=[tf.keras.metrics.MeanIoU(num_classes=<span class="hljs-number" style="color: teal;">2</span>)])
</div></pre>



<h3>tf.keras regression metrics</h3>



<p>Just like Keras, tf.keras has similar regression metrics. We won’t dwell on them much but there is an interesting metric to highlight called&nbsp;<em><strong>MeanRelativeError</strong></em>. &nbsp;</p>



<p><em><strong>MeanRelativeError</strong></em>&nbsp;takes&nbsp; the absolute error for an observation and divides it by constant. This constant,&nbsp;<strong>normalizer</strong>, can be the same for all observations or different for each sample.&nbsp;</p>



<p>Therefore, the mean relative error is the average of the relative errors.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>tf.keras.metrics.MeanRelativeError(normalizer=[<span class="hljs-number" style="color: teal;">1</span>, <span class="hljs-number" style="color: teal;">3</span>, <span class="hljs-number" style="color: teal;">2</span>, <span class="hljs-number" style="color: teal;">3</span>])</div></pre>





<h2>How to create a custom metric in tf.keras?</h2>



<p>In<em>&nbsp;tf.keras</em>&nbsp;you can create a custom metric by extending the&nbsp;<em>keras.metrics.Metric</em>&nbsp;class.</p>



<p>To do so you have to override the update_state, result, and reset_state functions:</p>


<div class="custom-point-list">
<ul><li><em><strong>update_state()</strong></em>&nbsp;does all the updates to state variables and calculates the metric,</li><li><em><strong>result()</strong></em>&nbsp;returns the value for the metric from state variables,</li><li><em><strong>reset_state()</strong></em>&nbsp;sets the metric value at the beginning of each epoch to a predefined constant (typically 0)</li></ul>
</div>


<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);font-size:14px"><div><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">MulticlassTruePositives</span><span class="hljs-params">(tf.keras.metrics.Metric)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, name=<span class="hljs-string" style="color: rgb(221, 17, 68);">'multiclass_true_positives'</span>, **kwargs)</span>:</span>
        super(MulticlassTruePositives, self).__init__(name=name, **kwargs)
        self.true_positives = self.add_weight(name=<span class="hljs-string" style="color: rgb(221, 17, 68);">'tp'</span>, initializer=<span class="hljs-string" style="color: rgb(221, 17, 68);">'zeros'</span>)

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">update_state</span><span class="hljs-params">(self, y_true, y_pred, sample_weight=None)</span>:</span>
        y_pred = tf.reshape(tf.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>), shape=(<span class="hljs-number" style="color: teal;">-1</span>, <span class="hljs-number" style="color: teal;">1</span>))
        values = tf.cast(y_true, <span class="hljs-string" style="color: rgb(221, 17, 68);">'int32'</span>) == tf.cast(y_pred, <span class="hljs-string" style="color: rgb(221, 17, 68);">'int32'</span>)
        values = tf.cast(values, <span class="hljs-string" style="color: rgb(221, 17, 68);">'float32'</span>)
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">if</span> sample_weight <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">is</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">not</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">None</span>:
            sample_weight = tf.cast(sample_weight, <span class="hljs-string" style="color: rgb(221, 17, 68);">'float32'</span>)
            values = tf.multiply(values, sample_weight)
        self.true_positives.assign_add(tf.reduce_sum(values))

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">result</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> self.true_positives

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">reset_states</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># The state of the metric will be reset at the start of each epoch.</span>
        self.true_positives.assign(<span class="hljs-number" style="color: teal;">0.</span>)</div></pre>



<p>Then we simply pass it at compile stage:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>model.compile(...,metrics=[MulticlassTruePositives()])
</div></pre>





<h2>Performance charts: ROC curve and confusion matrix in Keras</h2>



<p><strong>Sometimes the performance cannot be represented as one number</strong>&nbsp;but rather as a performance chart. Examples of such charts are ROC curve or confusion matrix. In those cases, you may want to log those charts somewhere for further inspection.</p>



<p><strong>To do it you need to create a callback</strong>&nbsp;that will track the performance of your model on every epoch end. Then, you can take a look at the improvement in a folder or an&nbsp;<a href="https://docs.neptune.ai/integrations-and-supported-tools/model-training/tensorflow-keras" target="_blank" rel="noreferrer noopener">experiment tracking tool</a>. So let’s do that.</p>



<p>First, we need a callback that creates ROC curve and confusion matrix at the end of each epoch.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);font-size:14px"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> os

<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> keras.callbacks <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> Callback
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> matplotlib.pyplot <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> plt
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> numpy <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> np
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> scikitplot.metrics <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> plot_confusion_matrix, plot_roc


<span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">PerformanceVisualizationCallback</span><span class="hljs-params">(Callback)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, model, validation_data, image_dir)</span>:</span>
        super().__init__()
        self.model = model
        self.validation_data = validation_data
        
        os.makedirs(image_dir, exist_ok=<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">True</span>)
        self.image_dir = image_dir

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_epoch_end</span><span class="hljs-params">(self, epoch, logs={})</span>:</span>
        y_pred = np.asarray(self.model.predict(self.validation_data[<span class="hljs-number" style="color: teal;">0</span>]))
        y_true = self.validation_data[<span class="hljs-number" style="color: teal;">1</span>]             
        y_pred_class = np.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>)

        <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># plot and save confusion matrix</span>
        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>,<span class="hljs-number" style="color: teal;">12</span>))
        plot_confusion_matrix(y_true, y_pred_class, ax=ax)
        fig.savefig(os.path.join(self.image_dir, f<span class="hljs-string" style="color: rgb(221, 17, 68);">'confusion_matrix_epoch_{epoch}'</span>))

       <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># plot and save roc curve</span>
        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>,<span class="hljs-number" style="color: teal;">12</span>))
        plot_roc(y_true, y_pred, ax=ax)
        fig.savefig(os.path.join(self.image_dir, f<span class="hljs-string" style="color: rgb(221, 17, 68);">'roc_curve_epoch_{epoch}'</span>))
</div></pre>



<p>Now we simply pass it to the&nbsp;<em>model.fit()</em>&nbsp;callbacks argument.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>performance_cbk = PerformanceVisualizationCallback(
                      model=model,
                      validation_data=validation_data,
                      image_dir=<span class="hljs-string" style="color: rgb(221, 17, 68);">'performance_vizualizations'</span>)

history = model.fit(x=x_train,
                    y=y_train,
                    epochs=<span class="hljs-number" style="color: teal;">5</span>,
                    validation_data=validation_data,
                    callbacks=[performance_cbk])</div></pre>



<p>You can have multiple callbacks if you want to.</p>



<p>Now you will be able to look at those visualizations as your model trains:</p>



<figure class="wp-block-video"><video controls="" src="https://neptune.ai/wp-content/uploads/keras_roc_curve_cut_hd.mp4"></video></figure>


<div class="note">
    <h3>Note:</h3>
    <div class="content">
                    <div class="wysiwyg_editor">
                                    <p>If you want to log everything to the experiment tracking tool like Neptune your callback would look a bit different:</p>
                            </div>
                    <div class="html_code">
                                <pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> keras.callbacks <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> Callback
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> neptune
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> numpy <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> np
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> scikitplot.metrics <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> plot_confusion_matrix, plot_roc
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> matplotlib.pyplot <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> plt

neptune.init(<span class="hljs-string" style="color: rgb(221, 17, 68);">'jakub-czakon/examples'</span>)
neptune.create_experiment(<span class="hljs-string" style="color: rgb(221, 17, 68);">'keras-metrics'</span>)

<span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">NeptuneLoggerCallback</span><span class="hljs-params">(Callback)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, model, validation_data)</span>:</span>
        super().__init__()
        self.model = model
        self.validation_data = validation_data

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_batch_end</span><span class="hljs-params">(self, batch, logs={})</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">for</span> log_name, log_value <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">in</span> logs.items():
            neptune.log_metric(f<span class="hljs-string" style="color: rgb(221, 17, 68);">'batch_{log_name}'</span>, log_value)

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_epoch_end</span><span class="hljs-params">(self, epoch, logs={})</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">for</span> log_name, log_value <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">in</span> logs.items():
            neptune.log_metric(f<span class="hljs-string" style="color: rgb(221, 17, 68);">'epoch_{log_name}'</span>, log_value)

        y_pred = np.asarray(self.model.predict(self.validation_data[<span class="hljs-number" style="color: teal;">0</span>]))
        y_true = self.validation_data[<span class="hljs-number" style="color: teal;">1</span>]

        y_pred_class = np.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>)

        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>, <span class="hljs-number" style="color: teal;">12</span>))
        plot_confusion_matrix(y_true, y_pred_class, ax=ax)
        neptune.log_image(<span class="hljs-string" style="color: rgb(221, 17, 68);">'confusion_matrix'</span>, fig)

        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>, <span class="hljs-number" style="color: teal;">12</span>))
        plot_roc(y_true, y_pred, ax=ax)
        neptune.log_image(<span class="hljs-string" style="color: rgb(221, 17, 68);">'roc_curve'</span>, fig)</div></pre>                            </div>
                    <div class="wysiwyg_editor">
                                    <p>Notice that you&nbsp;<strong>don’t need to create folders for images as the charts will be sent to your tool directly.</strong>&nbsp;On the flip side you have to create an experiment to start tracking your runs.</p>
                            </div>
                    <div class="wysiwyg_editor">
                                    <p>Once you have that it is business as usual.</p>
                            </div>
                    <div class="html_code">
                                <pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>neptune_logger=NeptuneLoggerCallback(model=model,
                                     validation_data=validation_data)

history = model.fit(x=x_train,
                    y=y_train,
                    epochs=<span class="hljs-number" style="color: teal;">5</span>,
                    validation_data=validation_data,
                    callbacks=[neptune_logger])</div></pre>                            </div>
                    <div class="wysiwyg_editor">
                                    <p>You can explore metrics and performance charts in the app.</p>
                            </div>
                    <div class="video">
                                <div style="width: 640px;" class="wp-video"><!--[if lt IE 9]><script>document.createElement('video');</script><![endif]-->
<span class="mejs-offscreen">Video Player</span><div id="mep_0" class="mejs-container mejs-container-keyboard-inactive wp-video-shortcode mejs-video" tabindex="0" role="application" aria-label="Video Player" style="width: 640px; height: 327.5px; min-width: 215px;"><div class="mejs-inner"><div class="mejs-mediaelement"><mediaelementwrapper id="video-34607-1"><video class="wp-video-shortcode" id="video-34607-1_html5" width="640" height="390" preload="metadata" src="https://neptune.ai/wp-content/uploads/keras_experiment_tracking_cut_hd.mp4?_=1" style="width: 640px; height: 327.5px;"><source type="video/mp4" src="https://neptune.ai/wp-content/uploads/keras_experiment_tracking_cut_hd.mp4?_=1"><a href="https://neptune.ai/wp-content/uploads/keras_experiment_tracking_cut_hd.mp4">https://neptune.ai/wp-content/uploads/keras_experiment_tracking_cut_hd.mp4</a></video></mediaelementwrapper></div><div class="mejs-layers"><div class="mejs-poster mejs-layer" style="display: none; width: 100%; height: 100%;"></div><div class="mejs-overlay mejs-layer" style="width: 100%; height: 100%; display: none;"><div class="mejs-overlay-loading"><span class="mejs-overlay-loading-bg-img"></span></div></div><div class="mejs-overlay mejs-layer" style="display: none; width: 100%; height: 100%;"><div class="mejs-overlay-error"></div></div><div class="mejs-overlay mejs-layer mejs-overlay-play" style="width: 100%; height: 100%;"><div class="mejs-overlay-button" role="button" tabindex="0" aria-label="Play" aria-pressed="false"></div></div></div><div class="mejs-controls"><div class="mejs-button mejs-playpause-button mejs-play"><button type="button" aria-controls="mep_0" title="Play" aria-label="Play" tabindex="0"></button></div><div class="mejs-time mejs-currenttime-container" role="timer" aria-live="off"><span class="mejs-currenttime">00:00</span></div><div class="mejs-time-rail"><span class="mejs-time-total mejs-time-slider" role="slider" tabindex="0" aria-label="Time Slider" aria-valuemin="0" aria-valuemax="24.064" aria-valuenow="0" aria-valuetext="00:00"><span class="mejs-time-buffering" style="display: none;"></span><span class="mejs-time-loaded" style="transform: scaleX(0.134184);"></span><span class="mejs-time-current" style="transform: scaleX(0);"></span><span class="mejs-time-hovered no-hover"></span><span class="mejs-time-handle" style="transform: translateX(0px);"><span class="mejs-time-handle-content"></span></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div><div class="mejs-time mejs-duration-container"><span class="mejs-duration">00:24</span></div><div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="mep_0" title="Mute" aria-label="Mute" tabindex="0"></button><a href="javascript:void(0);" class="mejs-volume-slider" aria-label="Volume Slider" aria-valuemin="0" aria-valuemax="100" role="slider" aria-orientation="vertical" aria-valuenow="80" aria-valuetext="80%"><span class="mejs-offscreen">Use Up/Down Arrow keys to increase or decrease volume.</span><div class="mejs-volume-total"><div class="mejs-volume-current" style="bottom: 0px; height: 80%;"></div><div class="mejs-volume-handle" style="bottom: 80%; margin-bottom: -3px;"></div></div></a></div><div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="mep_0" title="Fullscreen" aria-label="Fullscreen" tabindex="0"></button></div></div></div></div></div>                            </div>
            </div>
</div>


<div id="block_5ffefbec57a4c" class="separator separator-5"></div>



<h2>How to plot Keras history object?</h2>



<p>Whenever&nbsp;<em>fit()</em>&nbsp;is called, it returns a&nbsp;<strong><em>History</em></strong>&nbsp;object that can be used to visualize the training history.&nbsp;<strong>It contains a dictionary with loss and metric values</strong>&nbsp;at each epoch calculated both for training and validation datasets.</p>



<p>For example, lets extract the ‘<em>accuracy</em>’ metric and use matplotlib to plot it.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> matplotlib.pyplot <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> plt

history = model.fit(x_train, y_train, 
                    validation_split=<span class="hljs-number" style="color: teal;">0.25</span>, 
                    epochs=<span class="hljs-number" style="color: teal;">50</span>, batch_size=<span class="hljs-number" style="color: teal;">16</span>, verbose=<span class="hljs-number" style="color: teal;">1</span>)

<span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># Plot training &amp; validation accuracy values</span>
plt.plot(history.history[<span class="hljs-string" style="color: rgb(221, 17, 68);">'accuracy'</span>])
plt.plot(history.history[<span class="hljs-string" style="color: rgb(221, 17, 68);">'val_‘accuracy'</span>])
plt.title(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Model accuracy'</span>)
plt.ylabel(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Accuracy'</span>)
plt.xlabel(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Epoch'</span>)
plt.legend([<span class="hljs-string" style="color: rgb(221, 17, 68);">'Train'</span>, <span class="hljs-string" style="color: rgb(221, 17, 68);">'Test'</span>], loc=<span class="hljs-string" style="color: rgb(221, 17, 68);">'upper left'</span>)
plt.show()</div></pre>



<div class="wp-block-image"><figure class="aligncenter"><img src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/history.png" alt="keras history plot"></figure></div>





<h2>Keras metrics example</h2>



<p>Ok, so you’ve gone a long way and learned a bunch. To refresh your memory&nbsp;<strong>let’s put it all together in an single example.</strong></p>



<p>We’ll start by taking the mnist dataset and created a simple CNN model:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> tensorflow <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> tf

mnist = tf.keras.datasets.mnist

(x_train, y_train), (x_test, y_test) = mnist.load_data()
x_train, x_test = x_train / <span class="hljs-number" style="color: teal;">255.0</span>, x_test / <span class="hljs-number" style="color: teal;">255.0</span>
validation_data = x_test, y_test

model = tf.keras.models.Sequential([
    tf.keras.layers.Flatten(input_shape=(<span class="hljs-number" style="color: teal;">28</span>, <span class="hljs-number" style="color: teal;">28</span>)),
    tf.keras.layers.Dense(<span class="hljs-number" style="color: teal;">512</span>, activation=<span class="hljs-string" style="color: rgb(221, 17, 68);">'relu'</span>),
    tf.keras.layers.Dropout(<span class="hljs-number" style="color: teal;">0.2</span>),
    tf.keras.layers.Dense(<span class="hljs-number" style="color: teal;">10</span>, activation=<span class="hljs-string" style="color: rgb(221, 17, 68);">'softmax'</span>)
])
</div></pre>



<p>We’ll create a custom metric, multiclass&nbsp;<strong>f1 score in keras</strong>:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">recall</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    y_true = K.ones_like(y_true) 
    true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    all_positives = K.sum(K.round(K.clip(y_true, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    
    recall = true_positives / (all_positives + K.epsilon())
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> recall

<span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">precision</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    y_true = K.ones_like(y_true) 
    true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    
    predicted_positives = K.sum(K.round(K.clip(y_pred, <span class="hljs-number" style="color: teal;">0</span>, <span class="hljs-number" style="color: teal;">1</span>)))
    precision = true_positives / (predicted_positives + K.epsilon())
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> precision

<span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">f1_score</span><span class="hljs-params">(y_true, y_pred)</span>:</span>
    precision = precision_m(y_true, y_pred)
    recall = recall_m(y_true, y_pred)
    <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> <span class="hljs-number" style="color: teal;">2</span>*((precision*recall)/(precision+recall+K.epsilon()))
</div></pre>



<p>We’ll create a custom tf.keras metric:&nbsp;<strong>MulticlassTruePositives</strong>&nbsp;to be exact:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);font-size:14px"><div><span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">MulticlassTruePositives</span><span class="hljs-params">(tf.keras.metrics.Metric)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, name=<span class="hljs-string" style="color: rgb(221, 17, 68);">'multiclass_true_positives'</span>, **kwargs)</span>:</span>
        super(MulticlassTruePositives, self).__init__(name=name, **kwargs)
        self.true_positives = self.add_weight(name=<span class="hljs-string" style="color: rgb(221, 17, 68);">'tp'</span>, initializer=<span class="hljs-string" style="color: rgb(221, 17, 68);">'zeros'</span>)

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">update_state</span><span class="hljs-params">(self, y_true, y_pred, sample_weight=None)</span>:</span>
        y_pred = tf.reshape(tf.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>), shape=(<span class="hljs-number" style="color: teal;">-1</span>, <span class="hljs-number" style="color: teal;">1</span>))
        values = tf.cast(y_true, <span class="hljs-string" style="color: rgb(221, 17, 68);">'int32'</span>) == tf.cast(y_pred, <span class="hljs-string" style="color: rgb(221, 17, 68);">'int32'</span>)
        values = tf.cast(values, <span class="hljs-string" style="color: rgb(221, 17, 68);">'float32'</span>)
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">if</span> sample_weight <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">is</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">not</span> <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">None</span>:
            sample_weight = tf.cast(sample_weight, <span class="hljs-string" style="color: rgb(221, 17, 68);">'float32'</span>)
            values = tf.multiply(values, sample_weight)
        self.true_positives.assign_add(tf.reduce_sum(values))

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">result</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">return</span> self.true_positives

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">reset_states</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># The state of the metric will be reset at the start of each epoch.</span>
        self.true_positives.assign(<span class="hljs-number" style="color: teal;">0.</span>)</div></pre>



<p>We’ll&nbsp;<strong>compile the keras model</strong>&nbsp;with our metrics:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> keras

model.compile(optimizer=<span class="hljs-string" style="color: rgb(221, 17, 68);">'sgd'</span>,
              loss=<span class="hljs-string" style="color: rgb(221, 17, 68);">'sparse_categorical_crossentropy'</span>,
              metrics=[<span class="hljs-string" style="color: rgb(221, 17, 68);">'accuracy'</span>,
                       keras.metrics.categorical_accuracy,
                       f1_score, 
                       recall_score, 
                       precision_score,
                       tf.keras.metrics.TopKCategoricalAccuracy(k=<span class="hljs-number" style="color: teal;">5</span>),
                       MulticlassTruePositives()])</div></pre>



<p>We’ll implement keras&nbsp;<strong>callback that plots ROC curve and Confusion Matrix</strong>&nbsp;to a folder:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);font-size:14px"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> os

<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> keras.callbacks <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> Callback
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> matplotlib.pyplot <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> plt
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> numpy <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">as</span> np
<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span> scikitplot.metrics <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> plot_confusion_matrix, plot_roc

<span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">PerformanceVisualizationCallback</span><span class="hljs-params">(Callback)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, model, validation_data, image_dir)</span>:</span>
        super().__init__()
        self.model = model
        self.validation_data = validation_data
        
        os.makedirs(image_dir, exist_ok=<span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">True</span>)
        self.image_dir = image_dir

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_epoch_end</span><span class="hljs-params">(self, epoch, logs={})</span>:</span>
        y_pred = np.asarray(self.model.predict(self.validation_data[<span class="hljs-number" style="color: teal;">0</span>]))
        y_true = self.validation_data[<span class="hljs-number" style="color: teal;">1</span>]             
        y_pred_class = np.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>)

        <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># plot and save confusion matrix</span>
        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>,<span class="hljs-number" style="color: teal;">12</span>))
        plot_confusion_matrix(y_true, y_pred_class, ax=ax)
        fig.savefig(os.path.join(self.image_dir, f<span class="hljs-string" style="color: rgb(221, 17, 68);">'confusion_matrix_epoch_{epoch}'</span>))

       <span class="hljs-comment" style="color: rgb(153, 153, 136); font-style: italic;"># plot and save roc curve</span>
        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>,<span class="hljs-number" style="color: teal;">12</span>))
        plot_roc(y_true, y_pred, ax=ax)
        fig.savefig(os.path.join(self.image_dir, f<span class="hljs-string" style="color: rgb(221, 17, 68);">'roc_curve_epoch_{epoch}'</span>))

performance_viz_cbk = PerformanceVisualizationCallback(
                                       model=model,
                                       validation_data=validation_data,
                                       image_dir=<span class="hljs-string" style="color: rgb(221, 17, 68);">'perorfmance_charts'</span>)</div></pre>



<p>We’ll<strong>&nbsp;run training</strong>&nbsp;and monitor the performance:</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>history = model.fit(x=x_train,
                    y=y_train,
                    epochs=<span class="hljs-number" style="color: teal;">5</span>,
                    validation_data=validation_data,
                    callbacks=[performance_viz_cbk])</div></pre>



<p>We’ll&nbsp;<strong>visualize metrics from keras history object:</strong></p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>plt.plot(history.history[<span class="hljs-string" style="color: rgb(221, 17, 68);">'accuracy'</span>])
plt.plot(history.history[<span class="hljs-string" style="color: rgb(221, 17, 68);">'val_accuracy'</span>])
plt.title(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Model accuracy'</span>)
plt.ylabel(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Accuracy'</span>)
plt.xlabel(<span class="hljs-string" style="color: rgb(221, 17, 68);">'Epoch'</span>)
plt.legend([<span class="hljs-string" style="color: rgb(221, 17, 68);">'Train'</span>, <span class="hljs-string" style="color: rgb(221, 17, 68);">'Test'</span>], loc=<span class="hljs-string" style="color: rgb(221, 17, 68);">'upper left'</span>)
plt.show()
</div></pre>



<p>We will monitor and explore your experiments in a tool like TensorBoard or Neptune.</p>



<p>You just need to&nbsp;<strong>add another callback or modify the one you have</strong>&nbsp;created before:</p>



<hr class="wp-block-separator">



<p class="blog-cta-intext has-background" style="background-color:#f7f8fc"><strong><span style="text-decoration: underline;"><sup>COMPARE TOOLS<br></sup></span></strong><a href="https://neptune.ai/vs/tensorboard" target="_blank" rel="noreferrer noopener nofollow"><img draggable="false" role="img" class="emoji" alt="👉" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/1f449.svg"></a> <a href="https://neptune.ai/vs/tensorboard" target="_blank" rel="noreferrer noopener">See the comparison between TensorBoard and Neptune</a><br><img draggable="false" role="img" class="emoji" alt="👉" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/1f449.svg"> Read the article <a href="https://neptune.ai/blog/mlflow-vs-tensorboard-vs-neptune-what-are-the-differences" target="_blank" rel="noreferrer noopener">MLflow vs. TensorBoard vs. Neptune – What Are the Differences?</a></p>



<hr class="wp-block-separator">



<h2>TensorBoard</h2>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">from</span>  tf.keras.callbacks <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">import</span> TensorBoard

tensorboard_cbk = TensorBoard(log_dir=<span class="hljs-string" style="color: rgb(221, 17, 68);">"logs/training-example/"</span>)

history = model.fit(..., callbacks=[performance_viz_cbk, 
                                    tensorboard_cbk])</div></pre>



<p>With TensorBoard you need to start a local server and explore your runs in the browser.</p>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);"><div>tensorboard --logdir logs/training-example/</div></pre>



<div class="wp-block-image"><figure class="aligncenter"><img src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/tensorboard_terminal.png" alt="tensorboard keras"></figure></div>



<hr class="wp-block-separator">



<p class="blog-cta-intext has-background" style="background-color:#f7f8fc"><strong><span style="text-decoration: underline;"><sup>READ NEXT<br></sup></span></strong><a href="https://neptune.ai/blog/tensorboard-tutorial" target="_blank" rel="noreferrer noopener">Deep Dive into TensorBoard: Tutorial With Examples</a></p>



<hr class="wp-block-separator">



<h2>Neptune</h2>



<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; color: rgb(51, 51, 51); background: rgb(248, 248, 248);font-size:14px"><div>neptune.init(<span class="hljs-string" style="color: rgb(221, 17, 68);">'jakub-czakon/examples'</span>)
neptune.create_experiment(<span class="hljs-string" style="color: rgb(221, 17, 68);">'keras-metrics'</span>)

<span class="hljs-class"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">class</span> <span class="hljs-title" style="color: rgb(68, 85, 136); font-weight: 700;">NeptuneLoggerCallback</span><span class="hljs-params">(Callback)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">__init__</span><span class="hljs-params">(self, model, validation_data)</span>:</span>
        super().__init__()
        self.model = model
        self.validation_data = validation_data

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_batch_end</span><span class="hljs-params">(self, batch, logs={})</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">for</span> log_name, log_value <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">in</span> logs.items():
            neptune.log_metric(f<span class="hljs-string" style="color: rgb(221, 17, 68);">'batch_{log_name}'</span>, log_value)

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">def</span> <span class="hljs-title" style="color: rgb(153, 0, 0); font-weight: 700;">on_epoch_end</span><span class="hljs-params">(self, epoch, logs={})</span>:</span>
        <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">for</span> log_name, log_value <span class="hljs-keyword" style="color: rgb(51, 51, 51); font-weight: 700;">in</span> logs.items():
            neptune.log_metric(f<span class="hljs-string" style="color: rgb(221, 17, 68);">'epoch_{log_name}'</span>, log_value)

        y_pred = np.asarray(self.model.predict(self.validation_data[<span class="hljs-number" style="color: teal;">0</span>]))
        y_true = self.validation_data[<span class="hljs-number" style="color: teal;">1</span>]

        y_pred_class = np.argmax(y_pred, axis=<span class="hljs-number" style="color: teal;">1</span>)

        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>, <span class="hljs-number" style="color: teal;">12</span>))
        plot_confusion_matrix(y_true, y_pred_class, ax=ax)
        neptune.log_image(<span class="hljs-string" style="color: rgb(221, 17, 68);">'confusion_matrix'</span>, fig)

        fig, ax = plt.subplots(figsize=(<span class="hljs-number" style="color: teal;">16</span>, <span class="hljs-number" style="color: teal;">12</span>))
        plot_roc(y_true, y_pred, ax=ax)
        neptune.log_image(<span class="hljs-string" style="color: rgb(221, 17, 68);">'roc_curve'</span>, fig)

neptune_logger = NeptuneLoggerCallback(model=model,
                                       validation_data=validation_data)

history = model.fit(..., callbacks=[neptune_logger])</div></pre>



<p>Check this&nbsp;<a href="https://ui.neptune.ai/jakub-czakon/examples/e/EX-501/charts" target="_blank" rel="noreferrer noopener">example experiment run</a>&nbsp;if you are interested:</p>



<figure class="wp-block-video"><video controls="" src="https://neptune.ai/wp-content/uploads/keras_experiment_tracking_cut_hd-1.mp4"></video></figure>



<p><img draggable="false" role="img" class="emoji" alt="👉" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/1f449.svg"> Learn more about Neptune’s integration with <a href="https://docs.neptune.ai/integrations-and-supported-tools/model-training/tensorflow-keras" target="_blank" rel="noreferrer noopener">Keras</a>.</p>



<h2>Final thoughts</h2>



<p>Hopefully, this article gave you some background into model evaluation techniques in keras.</p>



<p>We’ve covered:</p>


<div class="custom-point-list">
<ul><li>built-in methods in keras and tf.keras,</li><li>implementation of your own custom metrics,</li><li>how you can visualize custom performance charts as your model is training.</li></ul>
</div>


<p>For more information check out the&nbsp;<a href="https://github.com/keras-team/keras/blob/master/keras/metrics.py" target="_blank" rel="noreferrer noopener">Keras Repository</a>&nbsp;and&nbsp;<a href="https://www.tensorflow.org/api_docs/python/tf/keras/metrics" target="_blank" rel="noreferrer noopener">TensorFlow Metrics documentation</a>.</p>



<p>Happy training!</p>




<div id="author-box-new-format-block_6007356684165" class="article__footer article__author">
  <div class="article__authorImage">
          <img width="193" height="193" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/Derrick-Mwiti.png" class="article__authorImage-img jetpack-lazy-image" alt="Derrick Mwiti" loading="lazy" data-attachment-id="34722" data-permalink="https://neptune.ai/blog/keras-metrics/derrick-mwiti" data-orig-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Derrick-Mwiti.png?fit=193%2C193&amp;ssl=1" data-orig-size="193,193" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Derrick Mwiti" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Derrick-Mwiti.png?fit=193%2C193&amp;ssl=1" data-large-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Derrick-Mwiti.png?fit=193%2C193&amp;ssl=1" data-lazy-src="https://i0.wp.com/neptune.ai/wp-content/uploads/Derrick-Mwiti.png?fit=193%2C193&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">      </div>

  <div class="article__authorContent">
          <h3 class="article__authorContent-name">Derrick Mwiti</h3>
    
          <p class="article__authorContent-text">Derrick Mwiti is a data scientist who has a great passion for sharing knowledge. He is an avid contributor to the data science community via blogs such as Heartbeat, Towards Data Science, Datacamp, Neptune AI, KDnuggets just to mention a few. His content has been viewed over a million times on the internet. Derrick is also an author and online instructor. He also trains and works with various institutions to implement data science solutions as well as to upskill their staff. You might want to check his Complete Data Science &amp; Machine Learning Bootcamp in Python course.</p>
    
          <ul class="article__authorSocial">
        <li class="article__authorSocial-single article__authorSocial-name">Follow me on</li>
                  <li class="article__authorSocial-single"><a href="https://twitter.com/_mwitiderrick" class="article__authorSocial-tw" target="_blank"></a></li>
        
                  <li class="article__authorSocial-single"><a href="https://www.linkedin.com/in/mwitiderrick/" class="article__authorSocial-lk" target="_blank"></a></li>
        
              </ul>
    
  </div>
</div>


<div class="wp-block-group"><div class="wp-block-group__inner-container">
<hr class="wp-block-separator">



<p class="has-text-color" style="color:#4455a6"><strong>READ NEXT</strong></p>



<h2>How to Track Machine Learning Model Metrics in Your Projects</h2>



<p class="has-small-font-size">3 min read | Jakub Czakon | Posted June 22, 2020</p>


<div id="block_5ffc75def9f8e" class="separator separator-10"></div>



<p>It is crucial to keep track of evaluation metrics for your machine learning models to:</p>


<div class="custom-point-list">
<ul><li>understand how your model is doing</li><li>be able to compare it with previous baselines and ideas</li><li>understand how far you are from the project goals</li></ul>
</div>


<p><strong>“If you don’t measure it you can’t improve it.”</strong></p>



<p>But what should you keep track of?</p>



<p>I have never found myself in a situation where I thought that I had logged too many metrics for my machine learning experiment.</p>



<p>Also, in a real-world project, the metrics you care about can change due to new discoveries or changing specifications, so logging more metrics can actually save you some time and trouble in the future.</p>



<p>Either way, my suggestion is:</p>



<p><strong>“Log more metrics than you think you need.”</strong></p>



<p>Ok, but how do you do that exactly?</p>



<h3>Tracking metrics that are a single number</h3>



<p>In many situations, you can assign a numerical value to the performance of your machine learning model. You can calculate the accuracy, AUC, or average precision on a held-out validation set and use it as your model evaluation metric.</p>



<p>In that case, you should keep track of all of those values for every single experiment run.</p>


<a class="button continous-post blue-filled" href="https://neptune.ai/blog/how-to-track-machine-learning-model-metrics" target="_blank">
    Continue reading -&gt;</a>



<hr class="wp-block-separator">
</div></div>



<p></p>
</div>
      </article>
    </div>

    
      <div class="blogSmall">
      <div class="blogSmall__single">
      <img width="355" height="185" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/AI-in-Drone-with-Tensorflow-Keras.jpg" class="blogSmall__single-img wp-post-image jetpack-lazy-image" alt="AI in Drone with Tensorflow Keras" loading="lazy" data-attachment-id="35206" data-permalink="https://neptune.ai/blog/applications-of-ai-in-drone-technology-machine-learning-models-with-tensorflow-keras/ai-in-drone-with-tensorflow-keras" data-orig-file="https://i2.wp.com/neptune.ai/wp-content/uploads/AI-in-Drone-with-Tensorflow-Keras.jpg?fit=1920%2C1377&amp;ssl=1" data-orig-size="1920,1377" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="AI in Drone with Tensorflow Keras" data-image-description="" data-image-caption="" data-medium-file="https://i2.wp.com/neptune.ai/wp-content/uploads/AI-in-Drone-with-Tensorflow-Keras.jpg?fit=300%2C215&amp;ssl=1" data-large-file="https://i2.wp.com/neptune.ai/wp-content/uploads/AI-in-Drone-with-Tensorflow-Keras.jpg?fit=1024%2C734&amp;ssl=1" data-lazy-src="https://i2.wp.com/neptune.ai/wp-content/uploads/AI-in-Drone-with-Tensorflow-Keras.jpg?resize=355%2C185&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">    <div class="blogSmall__content">
    <h3 class="blogSmall__content-title">Applications of AI in Drone Technology: Building Machine Learning Models That Work on Drones (With TensorFlow/Keras)</h3>
    <p class="blogSmall__content-author">
      <strong>by Brain John,</strong>
      <span class="blogSmall__content-day">December 30th, 2020</span>
    </p>
    <a href="https://neptune.ai/blog/applications-of-ai-in-drone-technology-machine-learning-models-with-tensorflow-keras" class="blogSmall__single-link">Read more</a>
  </div>
  <a href="https://neptune.ai/blog/applications-of-ai-in-drone-technology-machine-learning-models-with-tensorflow-keras" class="blogSmall__url"></a>
</div><div class="blogSmall__single">
      <img width="355" height="185" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/24-evaluation-metrics-featured.png" class="blogSmall__single-img wp-post-image jetpack-lazy-image" alt="24 evaluation metrics featured" loading="lazy" data-attachment-id="34625" data-permalink="https://neptune.ai/blog/evaluation-metrics-binary-classification/24-evaluation-metrics-featured" data-orig-file="https://i0.wp.com/neptune.ai/wp-content/uploads/24-evaluation-metrics-featured.png?fit=1920%2C1377&amp;ssl=1" data-orig-size="1920,1377" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="24 evaluation metrics featured" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/neptune.ai/wp-content/uploads/24-evaluation-metrics-featured.png?fit=300%2C215&amp;ssl=1" data-large-file="https://i0.wp.com/neptune.ai/wp-content/uploads/24-evaluation-metrics-featured.png?fit=1024%2C734&amp;ssl=1" data-lazy-src="https://i0.wp.com/neptune.ai/wp-content/uploads/24-evaluation-metrics-featured.png?resize=355%2C185&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">    <div class="blogSmall__content">
    <h3 class="blogSmall__content-title">24 Evaluation Metrics for Binary Classification (And When to Use Them)</h3>
    <p class="blogSmall__content-author">
      <strong>by Jakub Czakon,</strong>
      <span class="blogSmall__content-day">October 28th, 2019</span>
    </p>
    <a href="https://neptune.ai/blog/evaluation-metrics-binary-classification" class="blogSmall__single-link">Read more</a>
  </div>
  <a href="https://neptune.ai/blog/evaluation-metrics-binary-classification" class="blogSmall__url"></a>
</div><div class="blogSmall__single">
      <img width="355" height="185" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/TFX-Kubeflow.jpg" class="blogSmall__single-img wp-post-image jetpack-lazy-image" alt="TFX Kubeflow" loading="lazy" data-attachment-id="35090" data-permalink="https://neptune.ai/blog/deep-dive-into-ml-models-in-production-using-tfx-and-kubeflow/tfx-kubeflow" data-orig-file="https://i0.wp.com/neptune.ai/wp-content/uploads/TFX-Kubeflow.jpg?fit=1920%2C1377&amp;ssl=1" data-orig-size="1920,1377" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TFX Kubeflow" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/neptune.ai/wp-content/uploads/TFX-Kubeflow.jpg?fit=300%2C215&amp;ssl=1" data-large-file="https://i0.wp.com/neptune.ai/wp-content/uploads/TFX-Kubeflow.jpg?fit=1024%2C734&amp;ssl=1" data-lazy-src="https://i0.wp.com/neptune.ai/wp-content/uploads/TFX-Kubeflow.jpg?resize=355%2C185&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">    <div class="blogSmall__content">
    <h3 class="blogSmall__content-title">Deep Dive into ML Models in Production Using TensorFlow Extended (TFX) and Kubeflow</h3>
    <p class="blogSmall__content-author">
      <strong>by Rising Odegua,</strong>
      <span class="blogSmall__content-day">October 19th, 2020</span>
    </p>
    <a href="https://neptune.ai/blog/deep-dive-into-ml-models-in-production-using-tfx-and-kubeflow" class="blogSmall__single-link">Read more</a>
  </div>
  <a href="https://neptune.ai/blog/deep-dive-into-ml-models-in-production-using-tfx-and-kubeflow" class="blogSmall__url"></a>
</div><div class="blogSmall__single">
      <img width="355" height="185" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/Keras-loss-functions-1.png" class="blogSmall__single-img wp-post-image jetpack-lazy-image" alt="Keras loss functions" loading="lazy" data-attachment-id="35007" data-permalink="https://neptune.ai/blog/keras-loss-functions/keras-loss-functions-3" data-orig-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-loss-functions-1.png?fit=1920%2C1377&amp;ssl=1" data-orig-size="1920,1377" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Keras loss functions" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-loss-functions-1.png?fit=300%2C215&amp;ssl=1" data-large-file="https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-loss-functions-1.png?fit=1024%2C734&amp;ssl=1" data-lazy-src="https://i0.wp.com/neptune.ai/wp-content/uploads/Keras-loss-functions-1.png?resize=355%2C185&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">    <div class="blogSmall__content">
    <h3 class="blogSmall__content-title">Keras Loss Functions: Everything You Need To Know</h3>
    <p class="blogSmall__content-author">
      <strong>by Derrick Mwiti,</strong>
      <span class="blogSmall__content-day">July 8th, 2020</span>
    </p>
    <a href="https://neptune.ai/blog/keras-loss-functions" class="blogSmall__single-link">Read more</a>
  </div>
  <a href="https://neptune.ai/blog/keras-loss-functions" class="blogSmall__url"></a>
</div>    </div>
  

<div class="newsletter-horizontal if-viewport-hide-right-sidebar">
  <h3 class="newsletter-horizontal__headline">Top MLOps articles from our blog in your inbox every month.</h3>
  <form action="https://neptune.us19.list-manage.com/subscribe/post?u=8da2bdd288186da3ffeec5626&amp;id=59d3dc2c24" method="post" target="_blank" class="newsletter-horizontal__form">
    <div class="newsletter-horizontal__field">
      <input type="email" name="EMAIL" class="newsletter-horizontal__field-email" placeholder="Type your email here">
      <input type="submit" class="newsletter-horizontal__field-button" value="Get Newsletter">
    </div>
    <p class="newsletter-horizontal__form-rodo">GDPR compliant. <a href="https://neptune.ai/wp-content/uploads/privacy-policy.pdf">Privacy policy</a>.</p>
  </form>
</div>
  </section>


</main>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-12 col-lg-3 description">

                <div class="newsletter-container footer-newsletter">
                    <h3>Newsletter</h3>
                    <p>Top MLOps articles from our blog in your inbox every month.</p>
                    <form action="https://neptune.us19.list-manage.com/subscribe/post?u=8da2bdd288186da3ffeec5626&amp;id=59d3dc2c24" method="post" target="_blank" class="newsletter-horizontal__form">
                        <input type="email" name="EMAIL" placeholder="Type your email here" class="newsletterNew__form-email">
                        <input type="submit" value="Get Newsletter" class="newsletterNew__form-button">
                    </form>
                </div>

                                    <div class="logo">
                        <img width="47" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/footer-logo.svg" class="logo--footer-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="767" data-permalink="https://neptune.ai/footer-logo" data-orig-file="https://neptune.ai/wp-content/uploads/footer-logo.svg" data-orig-size="47,30" data-comments-opened="1" data-image-meta="[]" data-image-title="footer-logo" data-image-description="" data-image-caption="" data-medium-file="https://neptune.ai/wp-content/uploads/footer-logo.svg" data-large-file="https://neptune.ai/wp-content/uploads/footer-logo.svg" data-lazy-src="https://neptune.ai/wp-content/uploads/footer-logo.svg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                    </div>
                                <p>Neptune is a metadata store for MLOps, built for research and production teams that run a lot of experiments.</p>

                                    <ul class="social">
                                                    <li>
                                <a href="https://www.linkedin.com/company/neptuneai">
                                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/in.png" class="social-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="772" data-permalink="https://neptune.ai/in" data-orig-file="https://i2.wp.com/neptune.ai/wp-content/uploads/in.png?fit=30%2C30&amp;ssl=1" data-orig-size="30,30" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="in" data-image-description="" data-image-caption="" data-medium-file="https://i2.wp.com/neptune.ai/wp-content/uploads/in.png?fit=30%2C30&amp;ssl=1" data-large-file="https://i2.wp.com/neptune.ai/wp-content/uploads/in.png?fit=30%2C30&amp;ssl=1" data-lazy-src="https://neptune.ai/wp-content/uploads/in.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                                </a>
                            </li>
                                                    <li>
                                <a href="https://twitter.com/neptune_ai">
                                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/tw.png" class="social-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="773" data-permalink="https://neptune.ai/tw" data-orig-file="https://i2.wp.com/neptune.ai/wp-content/uploads/tw.png?fit=30%2C30&amp;ssl=1" data-orig-size="30,30" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="tw" data-image-description="" data-image-caption="" data-medium-file="https://i2.wp.com/neptune.ai/wp-content/uploads/tw.png?fit=30%2C30&amp;ssl=1" data-large-file="https://i2.wp.com/neptune.ai/wp-content/uploads/tw.png?fit=30%2C30&amp;ssl=1" data-lazy-src="https://neptune.ai/wp-content/uploads/tw.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                                </a>
                            </li>
                                                    <li>
                                <a href="https://www.facebook.com/neptuneAI">
                                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/fb.png" class="social-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="775" data-permalink="https://neptune.ai/fb" data-orig-file="https://i0.wp.com/neptune.ai/wp-content/uploads/fb.png?fit=30%2C30&amp;ssl=1" data-orig-size="30,30" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fb" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/neptune.ai/wp-content/uploads/fb.png?fit=30%2C30&amp;ssl=1" data-large-file="https://i0.wp.com/neptune.ai/wp-content/uploads/fb.png?fit=30%2C30&amp;ssl=1" data-lazy-src="https://neptune.ai/wp-content/uploads/fb.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/neptune-ai">
                                    <img width="30" height="30" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/Github-bottom-logo.svg" class="social-img jetpack-lazy-image" alt="" loading="lazy" data-attachment-id="40868" data-permalink="https://neptune.ai/github-bottom-logo" data-orig-file="https://neptune.ai/wp-content/uploads/Github-bottom-logo.svg" data-orig-size="30,30" data-comments-opened="0" data-image-meta="[]" data-image-title="Github bottom logo" data-image-description="" data-image-caption="" data-medium-file="https://neptune.ai/wp-content/uploads/Github-bottom-logo.svg" data-large-file="https://neptune.ai/wp-content/uploads/Github-bottom-logo.svg" data-lazy-src="https://neptune.ai/wp-content/uploads/Github-bottom-logo.svg?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">                                </a>
                            </li>
                                            </ul>
                
            </div>

            <div class="col-12 col-md-6 offset-lg-1 col-lg-4 menu-container">
                <div class="footer-menu"><h3>Product</h3><div class="menu-product-container"><ul id="menu-product" class="menu"><li id="menu-item-36797" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36797"><a href="https://neptune.ai/product">Overview</a></li>
<li id="menu-item-38779" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38779"><a href="https://neptune.ai/product/experiment-tracking">Experiment Tracking</a></li>
<li id="menu-item-38777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38777"><a href="https://neptune.ai/product/model-registry">Model Registry</a></li>
<li id="menu-item-38778" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-38778"><a href="https://neptune.ai/product#what-is-metadata-store">ML Metadata Store</a></li>
<li id="menu-item-36799" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36799"><a href="https://docs.neptune.ai/keep-track-of-jupyter-notebooks/index.html">Notebooks in Neptune</a></li>
<li id="menu-item-36798" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36798"><a href="https://docs.neptune.ai/getting-started/hello-world">Get Started</a></li>
<li id="menu-item-36792" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36792"><a href="https://docs.neptune.ai/integrations-and-supported-tools/languages/neptune-client-python">Python API</a></li>
<li id="menu-item-36793" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36793"><a href="https://docs.neptune.ai/integrations-and-supported-tools/languages/neptune-client-r">R Support</a></li>
<li id="menu-item-45809" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45809"><a href="https://neptune.ai/pricing">Pricing</a></li>
<li id="menu-item-36795" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36795"><a href="https://portal.neptune.ai/">Roadmap</a></li>
<li id="menu-item-36796" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36796"><a href="https://status.neptune.ai/">Service Status</a></li>
</ul></div></div><div class="footer-menu"><h3>Company</h3><div class="menu-company-container"><ul id="menu-company" class="menu"><li id="menu-item-21334" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21334"><a href="https://neptune.ai/about-us">About us</a></li>
<li id="menu-item-21335" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21335"><a href="https://neptune.ai/jobs">Jobs</a></li>
</ul></div></div><div class="footer-menu"><h3>Legal</h3><div class="menu-legal-container"><ul id="menu-legal" class="menu"><li id="menu-item-21345" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21345"><a href="https://neptune.ai/terms-of-service.pdf">Terms of service</a></li>
<li id="menu-item-21346" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21346"><a href="https://neptune.ai/privacy-policy.pdf">Privacy policy</a></li>
</ul></div></div>
            </div>
            <div class="col-12 col-md-6 col-lg-4 menu-container">
                <div class="footer-menu"><h3>Resources</h3><div class="menu-resources-container"><ul id="menu-resources" class="menu"><li id="menu-item-21348" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-21348"><a href="https://neptune.ai/blog">Neptune Blog</a></li>
<li id="menu-item-36871" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36871"><a href="https://docs.neptune.ai/">Neptune Docs</a></li>
<li id="menu-item-21349" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21349"><a href="https://docs.neptune.ai/integrations/index.html">Neptune Integrations</a></li>
<li id="menu-item-21350" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21350"><a href="https://neptune.ai/blog/ml-experiment-tracking">ML Experiment Tracking</a></li>
<li id="menu-item-21353" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21353"><a href="https://neptune.ai/blog/machine-learning-model-management-in-2020-and-beyond">ML Model Management</a></li>
<li id="menu-item-21351" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21351"><a href="https://neptune.ai/blog/mlops-what-it-is-why-it-matters-and-how-to-implement-it-from-a-data-scientist-perspective">MLOps</a></li>
<li id="menu-item-21352" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21352"><a href="https://neptune.ai/blog/data-science-project-management-in-2021-the-new-guide-for-ml-teams">ML Project Management</a></li>
</ul></div></div><div class="footer-menu"><h3>Competitor Comparison</h3><div class="menu-competitor-comparison-container"><ul id="menu-competitor-comparison" class="menu"><li id="menu-item-36800" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-36800"><a href="https://neptune.ai/blog/best-ml-experiment-tracking-tools">ML Experiment Tracking Tools</a></li>
<li id="menu-item-21339" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21339"><a href="https://neptune.ai/blog/the-best-mlflow-alternatives">Best MLflow Alternatives</a></li>
<li id="menu-item-21340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21340"><a href="https://neptune.ai/blog/the-best-tensorboard-alternatives">Best TensorBoard Alternatives</a></li>
<li id="menu-item-21341" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21341"><a href="https://neptune.ai/blog/the-best-kubeflow-alternatives">Best Kubeflow Alternatives</a></li>
<li id="menu-item-21342" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-21342"><a href="https://neptune.ai/vs">Other Alternatives</a></li>
</ul></div></div>            </div>
        </div>
    </div>
</footer>

<!--  -->
<script defer="" id="bilmur" data-provider="wordpress.com" data-service="atomic" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/bilmur.min.js.download"></script>
<!--googleoff: all--><div id="cookie-law-info-bar" data-nosnippet="true" style="background-color: rgb(255, 255, 255); color: rgb(204, 213, 255); font-family: inherit; bottom: 0px; position: fixed; display: block;"><span><div class="neptune-cookies">Neptune.ai uses cookies to ensure you get the best experience on this website. By continuing you agree to our use of cookies. <a href="https://neptune.ai/wp-content/uploads/privacy-policy.pdf" target="_blank">Learn more</a> <a role="button" tabindex="0" data-cli_action="accept" id="cookie_action_close_header" class="medium cli-plugin-button cli-plugin-main-button cookie_action_close_header cli_action_button" style="display: inline-block; color: rgb(255, 255, 255); background-color: rgb(0, 185, 120);">Got it!</a></div></span></div><div id="cookie-law-info-again" style="display: none; background-color: rgb(255, 255, 255); color: rgb(204, 213, 255); position: fixed; font-family: inherit; width: auto; bottom: 0px; right: 100px;" data-nosnippet="true"><span id="cookie_hdr_showagain">Manage consent</span></div><div class="cli-modal" data-nosnippet="true" id="cliSettingsPopup" tabindex="-1" role="dialog" aria-labelledby="cliSettingsPopup" aria-hidden="true">
  <div class="cli-modal-dialog" role="document">
	<div class="cli-modal-content cli-bar-popup">
	  	<button type="button" class="cli-modal-close" id="cliModalClose">
			<svg class="" viewBox="0 0 24 24"><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"></path><path d="M0 0h24v24h-24z" fill="none"></path></svg>
			<span class="wt-cli-sr-only">Close</span>
	  	</button>
	  	<div class="cli-modal-body">
			<div class="cli-container-fluid cli-tab-container">
	<div class="cli-row">
		<div class="cli-col-12 cli-align-items-stretch cli-px-0">
			<div class="cli-privacy-overview">
				<h4>Privacy Overview</h4>				<div class="cli-privacy-content">
					<div class="cli-privacy-content-text">This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the ...</div>
				</div>
				<a class="cli-privacy-readmore" aria-label="Show more" tabindex="0" role="button" data-readmore-text="Show more" data-readless-text="Show less"></a>			</div>
		</div>
		<div class="cli-col-12 cli-align-items-stretch cli-px-0 cli-tab-section-container">
												<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="necessary" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Necessary							</a>
							<div class="wt-cli-necessary-checkbox">
                        <input type="checkbox" class="cli-user-preference-checkbox" id="wt-cli-checkbox-necessary" data-id="checkbox-necessary" checked="checked">
                        <label class="form-check-label" for="wt-cli-checkbox-necessary">Necessary</label>
                    </div>
                    <span class="cli-necessary-caption">Always Enabled</span> 						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="necessary">
								<div class="wt-cli-cookie-description">
									Necessary cookies are absolutely essential for the website to function properly. These cookies ensure basic functionalities and security features of the website, anonymously.
<table class="cookielawinfo-row-cat-table cookielawinfo-winter"><thead><tr><th class="cookielawinfo-column-1">Cookie</th><th class="cookielawinfo-column-3">Duration</th><th class="cookielawinfo-column-4">Description</th></tr></thead><tbody><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">cookielawinfo-checbox-analytics</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Analytics".</td></tr><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">cookielawinfo-checbox-functional</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">The cookie is set by GDPR cookie consent to record the user consent for the cookies in the category "Functional".</td></tr><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">cookielawinfo-checbox-others</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Other.</td></tr><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">cookielawinfo-checkbox-necessary</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">This cookie is set by GDPR Cookie Consent plugin. The cookies is used to store the user consent for the cookies in the category "Necessary".</td></tr><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">cookielawinfo-checkbox-performance</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">This cookie is set by GDPR Cookie Consent plugin. The cookie is used to store the user consent for the cookies in the category "Performance".</td></tr><tr class="cookielawinfo-row"><td class="cookielawinfo-column-1">viewed_cookie_policy</td><td class="cookielawinfo-column-3">11 months</td><td class="cookielawinfo-column-4">The cookie is set by the GDPR Cookie Consent plugin and is used to store whether or not user has consented to the use of cookies. It does not store any personal data.</td></tr></tbody></table>								</div>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="functional" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Functional							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-functional" class="cli-user-preference-checkbox" data-id="checkbox-functional">
                        <label for="wt-cli-checkbox-functional" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Functional</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="functional">
								<div class="wt-cli-cookie-description">
									Functional cookies help to perform certain functionalities like sharing the content of the website on social media platforms, collect feedbacks, and other third-party features.
								</div>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="performance" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Performance							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-performance" class="cli-user-preference-checkbox" data-id="checkbox-performance">
                        <label for="wt-cli-checkbox-performance" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Performance</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="performance">
								<div class="wt-cli-cookie-description">
									Performance cookies are used to understand and analyze the key performance indexes of the website which helps in delivering a better user experience for the visitors.
								</div>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="analytics" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Analytics							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-analytics" class="cli-user-preference-checkbox" data-id="checkbox-analytics">
                        <label for="wt-cli-checkbox-analytics" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Analytics</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="analytics">
								<div class="wt-cli-cookie-description">
									Analytical cookies are used to understand how visitors interact with the website. These cookies help provide information on metrics the number of visitors, bounce rate, traffic source, etc.
								</div>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="advertisement" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Advertisement							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-advertisement" class="cli-user-preference-checkbox" data-id="checkbox-advertisement">
                        <label for="wt-cli-checkbox-advertisement" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Advertisement</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="advertisement">
								<div class="wt-cli-cookie-description">
									Advertisement cookies are used to provide visitors with relevant ads and marketing campaigns. These cookies track visitors across websites and collect information to provide customized ads.
								</div>
							</div>
						</div>
					</div>
																	<div class="cli-tab-section">
						<div class="cli-tab-header">
							<a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="others" data-toggle="cli-toggle-tab" data-original-title="" title="">
								Others							</a>
							<div class="cli-switch">
                        <input type="checkbox" id="wt-cli-checkbox-others" class="cli-user-preference-checkbox" data-id="checkbox-others">
                        <label for="wt-cli-checkbox-others" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Others</span></label>
                    </div>						</div>
						<div class="cli-tab-content">
							<div class="cli-tab-pane cli-fade" data-id="others">
								<div class="wt-cli-cookie-description">
									Other uncategorized cookies are those that are being analyzed and have not been classified into a category as yet.
								</div>
							</div>
						</div>
					</div>
										</div>
	</div>
</div>
	  	</div>
	  	<div class="cli-modal-footer">
			<div class="wt-cli-element cli-container-fluid cli-tab-container">
				<div class="cli-row">
					<div class="cli-col-12 cli-align-items-stretch cli-px-0">
						<div class="cli-tab-footer wt-cli-privacy-overview-actions">
						
															<a id="wt-cli-privacy-save-btn" role="button" tabindex="0" data-cli-action="accept" class="wt-cli-privacy-btn cli_setting_save_button wt-cli-privacy-accept-btn cli-btn">SAVE &amp; ACCEPT</a>
													</div>
						
					</div>
				</div>
			</div>
		</div>
	</div>
  </div>
</div>
<div class="cli-modal-backdrop cli-fade cli-settings-overlay" style="display: block;"></div>
<div class="cli-modal-backdrop cli-fade cli-popupbar-overlay" style="display: block;"></div>
<!--googleon: all--><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip">
                </div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div><link rel="stylesheet" id="note-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/note.css" type="text/css" media="all">
<link rel="stylesheet" id="separator-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/separator.css" type="text/css" media="all">
<link rel="stylesheet" id="author-new-format-box-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/author-new-format-box.css" type="text/css" media="all">
<link rel="stylesheet" id="button-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/button.css" type="text/css" media="all">
<link rel="stylesheet" id="cookie-law-info-table-css" href="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/cookie-law-info-table.css" type="text/css" media="all">
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/photon.min.js.download" id="jetpack-photon-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/regenerator-runtime.min.js.download" id="regenerator-runtime-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wp-polyfill.min.js.download" id="wp-polyfill-js"></script>
<script type="text/javascript" id="contact-form-7-js-extra">
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/neptune.ai\/wp-json\/","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/index.js.download" id="contact-form-7-js"></script>
<script type="text/javascript" id="lbwps-js-extra">
/* <![CDATA[ */
var lbwpsOptions = {"label_facebook":"Share on Facebook","label_twitter":"Tweet","label_pinterest":"Pin it","label_download":"Download image","label_copyurl":"Copy image URL","share_facebook":"1","share_twitter":"1","share_pinterest":"1","share_download":"1","share_direct":"0","share_copyurl":"0","share_custom_label":"","share_custom_link":"","wheelmode":"close","close_on_drag":"1","history":"1","show_counter":"1","show_fullscreen":"1","show_zoom":"1","show_caption":"1","loop":"1","pinchtoclose":"1","taptotoggle":"1","spacing":"12","close_on_click":"1","fulldesktop":"0","use_alt":"0","desktop_slider":"1","idletime":"4000","hide_scrollbars":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/scripts.js.download" id="lbwps-js"></script>
<script type="text/javascript" id="neptune-ajax-search-js-extra">
/* <![CDATA[ */
var neptune_ajax = {"ajaxurl":"https:\/\/neptune.ai\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/suggest-words.js.download" id="neptune-ajax-search-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/jquery.min.js.download" id="jquery2-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/popper.min.js.download" id="popper.js-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/bootstrap.min.js.download" id="bootstrap-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/reading.js.download" id="reading-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/main.js.download" id="main-js"></script>
<script type="text/javascript" id="neptune-ajax-cf7-js-extra">
/* <![CDATA[ */
var neptune_ajax_cf7 = {"ajaxurl":"https:\/\/neptune.ai\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/cf7.js.download" id="neptune-ajax-cf7-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/intersection-observer.js.download" id="jetpack-lazy-images-polyfill-intersectionobserver-js"></script>
<script type="text/javascript" id="jetpack-lazy-images-js-extra">
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/lazy-images.js.download" id="jetpack-lazy-images-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wp-embed.min.js.download" id="wp-embed-js"></script>
<script type="text/javascript" id="mediaelement-core-js-before">
var mejsL10n = {"language":"en","strings":{"mejs.download-file":"Download File","mejs.install-flash":"You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https:\/\/get.adobe.com\/flashplayer\/","mejs.fullscreen":"Fullscreen","mejs.play":"Play","mejs.pause":"Pause","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left\/Right Arrow keys to advance one second, Up\/Down arrows to advance ten seconds.","mejs.live-broadcast":"Live Broadcast","mejs.volume-help-text":"Use Up\/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.captions-subtitles":"Captions\/Subtitles","mejs.captions-chapters":"Chapters","mejs.none":"None","mejs.afrikaans":"Afrikaans","mejs.albanian":"Albanian","mejs.arabic":"Arabic","mejs.belarusian":"Belarusian","mejs.bulgarian":"Bulgarian","mejs.catalan":"Catalan","mejs.chinese":"Chinese","mejs.chinese-simplified":"Chinese (Simplified)","mejs.chinese-traditional":"Chinese (Traditional)","mejs.croatian":"Croatian","mejs.czech":"Czech","mejs.danish":"Danish","mejs.dutch":"Dutch","mejs.english":"English","mejs.estonian":"Estonian","mejs.filipino":"Filipino","mejs.finnish":"Finnish","mejs.french":"French","mejs.galician":"Galician","mejs.german":"German","mejs.greek":"Greek","mejs.haitian-creole":"Haitian Creole","mejs.hebrew":"Hebrew","mejs.hindi":"Hindi","mejs.hungarian":"Hungarian","mejs.icelandic":"Icelandic","mejs.indonesian":"Indonesian","mejs.irish":"Irish","mejs.italian":"Italian","mejs.japanese":"Japanese","mejs.korean":"Korean","mejs.latvian":"Latvian","mejs.lithuanian":"Lithuanian","mejs.macedonian":"Macedonian","mejs.malay":"Malay","mejs.maltese":"Maltese","mejs.norwegian":"Norwegian","mejs.persian":"Persian","mejs.polish":"Polish","mejs.portuguese":"Portuguese","mejs.romanian":"Romanian","mejs.russian":"Russian","mejs.serbian":"Serbian","mejs.slovak":"Slovak","mejs.slovenian":"Slovenian","mejs.spanish":"Spanish","mejs.swahili":"Swahili","mejs.swedish":"Swedish","mejs.tagalog":"Tagalog","mejs.thai":"Thai","mejs.turkish":"Turkish","mejs.ukrainian":"Ukrainian","mejs.vietnamese":"Vietnamese","mejs.welsh":"Welsh","mejs.yiddish":"Yiddish"}};
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/mediaelement-and-player.min.js.download" id="mediaelement-core-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/mediaelement-migrate.min.js.download" id="mediaelement-migrate-js"></script>
<script type="text/javascript" id="mediaelement-js-extra">
/* <![CDATA[ */
var _wpmejsSettings = {"pluginPath":"\/wp-includes\/js\/mediaelement\/","classPrefix":"mejs-","stretching":"responsive"};
/* ]]> */
</script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/wp-mediaelement.min.js.download" id="wp-mediaelement-js"></script>
<script type="text/javascript" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/vimeo.min.js.download" id="mediaelement-vimeo-js"></script>
<!-- Hotjar Tracking Code for neptune.ml -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:569747,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MZNL966"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



<!-- Intercom integration -->
<script>
    /* !
   * JavaScript Cookie v2.2.1
   * https://github.com/js-cookie/js-cookie
   *
   * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
   * Released under the MIT license
   *
   * Minified by jsDelivr using Terser v3.14.1.
   * Original file: /npm/js-cookie@2.2.1/src/js.cookie.js
   *
   * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
   */
    !function(e){var n;if("function"==typeof define&&define.amd&&(define(e),n=!0),"object"==typeof exports&&(module.exports=e(),n=!0),!n){var t=window.Cookies,o=window.Cookies=e();o.noConflict=function(){return window.Cookies=t,o}}}(function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var o in t)n[o]=t[o]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(o){function r(){}function i(n,t,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var c=JSON.stringify(t);/^[\{\[]/.test(c)&&(t=c)}catch(e){}t=o.write?o.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var f="";for(var u in i)i[u]&&(f+="; "+u,!0!==i[u]&&(f+="="+i[u].split(";")[0]));return document.cookie=n+"="+t+f}}function c(e,t){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],c=0;c<i.length;c++){var f=i[c].split("="),u=f.slice(1).join("=");t||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var a=n(f[0]);if(u=(o.read||o)(u,a)||n(u),t)try{u=JSON.parse(u)}catch(e){}if(r[a]=u,e===a)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return c(e,!1)},r.getJSON=function(e){return c(e,!0)},r.remove=function(n,t){i(n,"",e(t,{expires:-1}))},r.defaults={},r.withConverter=t,r}(function(){})});



    initIntercom(true);

    function initIntercom(isProduction) {
        var options = {
            devel: {
                appId: 'wqilukic',
            },
            prod: {
                appId: 'yoy39he9',
            },
        };

        var username = window.Cookies.get('neptune-uid');

        window.intercomSettings = {
            app_id: isProduction ? options.prod.appId : options.devel.appId,
        };

        var isUsernamePreserved = typeof username === 'string' && username.length > 0;
        if (isUsernamePreserved) {
            window.intercomSettings.user_id = username;
        }


        // Intercom official integration code }}}
        // eslint-disable-next-line
        (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/wqilukic';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
        // Intercom official integration code {{{
    }

</script><meta name="google-site-verification" content="HV7mAziXIZE7uHdEiuXiPv6eRLY4fifJqFVM671TABA">
<!-- End of Intercom integration -->



<!-- Heap integration -->
<script type="text/javascript">   
window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])};   
heap.load("3102000718"); 
</script> 
<!-- End of Heap integration -->
<script>
try {
  const search = new URLSearchParams(window.location.search);
  if (search.has('chat-with-us') && typeof window.Intercom === 'function') {
      window.Intercom('show');
  }
} catch (e) {}
</script><script src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/e-202141.js.download" defer=""></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.3-2110.1',blog:'158350742',post:'34607',tz:'2',srv:'neptune.ai'} ]);
	_stq.push([ 'clickTrackerInit', '158350742', '34607' ]);
</script>


    


<img src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/g.gif" alt=":)" width="6" height="5" id="wpstats"><iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/box-acff0d328b74363875a0a6075e6c8439.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./Keras Metrics_ Everything You Need To Know - neptune.ai-How to create a custom metrics_files/saved_resource.html"></iframe><div class="intercom-lightweight-app"><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: undefined;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    animation: intercom-lightweight-app-launcher 250ms ease;
  }

  .intercom-lightweight-app-launcher:focus {
    outline: none;
    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 60px;
    height: 60px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 28px;
    height: 32px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 56px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 36px;
    max-width: 36px;
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg {
    width: 16px;
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms ease-out;
    
        width: 376px;
        height: calc(100% - 40px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 20px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
        border-radius: 8px;
      
  }

  .intercom-lightweight-app-messenger-header {
    height: 75px;
    background: linear-gradient(
      135deg,
      undefined 0%,
      undefined 100%
    );
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>